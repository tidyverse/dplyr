<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Column-wise operations • dplyr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../tidyverse.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../tidyverse-2.css" rel="stylesheet">
<!--optional theme--><link href="../.css" rel="stylesheet">
<!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Column-wise operations">
<meta property="og:description" content="Learn how to easily repeat the same operation across multiple columns using `across()`.
">
<meta property="og:image" content="https://dplyr.tidyverse.org/logo.png">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">dplyr</a>
        <div class="info hidden-xs hidden-sm">
          <span class="partof">part of the <a href="https://tidyverse.org" class="external-link">tidyverse</a></span>
          <span class="version version-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">1.0.5.9000</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/dplyr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/grouping.html">Grouped data</a>
    </li>
    <li>
      <a href="../articles/two-table.html">Two-table verbs</a>
    </li>
    <li>
      <a href="../articles/base.html">dplyr &lt;-&gt; base R</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Automation</li>
    <li>
      <a href="../articles/colwise.html">Column-wise operations</a>
    </li>
    <li>
      <a href="../articles/rowwise.html">Row-wise operations</a>
    </li>
    <li>
      <a href="../articles/programming.html">Programming with dplyr</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/index.html">More...</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Releases</li>
    <li>
      <a href="https://www.tidyverse.org/blog/2020/06/dplyr-1-0-0/" class="external-link">Version 1.0.0</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2019/07/dplyr-0-8-3/" class="external-link">Version 0.8.3</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2019/06/dplyr-0-8-2/" class="external-link">Version 0.8.2</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2019/05/dplyr-0-8-1/" class="external-link">Version 0.8.1</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2019/02/dplyr-0-8-0/" class="external-link">Version 0.8.0</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2018/06/dplyr-0.7.5/" class="external-link">Version 0.7.5</a>
    </li>
    <li class="divider">
    <li>
      <a href="../news/index.html">Changelog</a>
    </li>
  </ul>
</li>
        <li>
  <a href="https://github.com/tidyverse/dplyr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="colwise_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Column-wise operations</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/dplyr/blob/master/vignettes/colwise.Rmd" class="external-link"><code>vignettes/colwise.Rmd</code></a></small>
      <div class="hidden name"><code>colwise.Rmd</code></div>

    </div>

    
    
<p>It’s often useful to perform the same operation on multiple columns, but copying and pasting is both tedious and error prone:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/summarise.html">summarise</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>, b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span>, c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span>, d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>(If you’re trying to compute <code><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean(a, b, c, d)</a></code> for each row, instead see <code><a href="../articles/rowwise.html">vignette("rowwise")</a></code>)</p>
<p>This vignette will introduce you to the <code><a href="../reference/across.html">across()</a></code> function, which lets you rewrite the previous code more succinctly:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="va">a</span><span class="op">:</span><span class="va">d</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We’ll start by discussing the basic usage of <code><a href="../reference/across.html">across()</a></code>, particularly as it applies to <code><a href="../reference/summarise.html">summarise()</a></code>, and show how to use it with multiple functions. We’ll then show a few uses with other verbs. We’ll finish off with a bit of history, showing why we prefer <code><a href="../reference/across.html">across()</a></code> to our last approach (the <code>_if()</code>, <code>_at()</code> and <code>_all()</code> functions) and how to translate your old code to the new syntax.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div id="basic-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-usage" class="anchor"></a>Basic usage</h2>
<p><code><a href="../reference/across.html">across()</a></code> has two primary arguments:</p>
<ul>
<li><p>The first argument, <code>.cols</code>, selects the columns you want to operate on. It uses tidy selection (like <code><a href="../reference/select.html">select()</a></code>) so you can pick variables by position, name, and type.</p></li>
<li><p>The second argument, <code>.fns</code>, is a function or list of functions to apply to each column. This can also be a purrr style formula (or list of formulas) like <code>~ .x / 2</code>. (This argument is optional, and you can omit it if you just want to get the underlying data; you’ll see that technique used in <code><a href="../articles/rowwise.html">vignette("rowwise")</a></code>.)</p></li>
</ul>
<p>Here are a couple of examples of <code><a href="../reference/across.html">across()</a></code> in conjunction with its favourite verb, <code><a href="../reference/summarise.html">summarise()</a></code>. But you can use <code><a href="../reference/across.html">across()</a></code> with any dplyr verb, as you’ll see a little later.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">starwars</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.character</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 8</span>
<span class="co">#&gt;    name hair_color skin_color eye_color   sex gender homeworld species</span>
<span class="co">#&gt;   &lt;int&gt;      &lt;int&gt;      &lt;int&gt;     &lt;int&gt; &lt;int&gt;  &lt;int&gt;     &lt;int&gt;   &lt;int&gt;</span>
<span class="co">#&gt; 1    87         13         31        15     5      3        49      38</span>

<span class="va">starwars</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="../reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sex</span>, <span class="va">gender</span>, <span class="va">homeworld</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 9 x 4</span>
<span class="co">#&gt;   species    sex gender homeworld</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;int&gt;  &lt;int&gt;     &lt;int&gt;</span>
<span class="co">#&gt; 1 Droid        1      2         3</span>
<span class="co">#&gt; 2 Gungan       1      1         1</span>
<span class="co">#&gt; 3 Human        2      2        16</span>
<span class="co">#&gt; 4 Kaminoan     2      2         1</span>
<span class="co">#&gt; # … with 5 more rows</span>

<span class="va">starwars</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">homeworld</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="../reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">.x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 10 x 4</span>
<span class="co">#&gt;   homeworld height  mass birth_year</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Alderaan    176.  64         43  </span>
<span class="co">#&gt; 2 Corellia    175   78.5       25  </span>
<span class="co">#&gt; 3 Coruscant   174.  50         91  </span>
<span class="co">#&gt; 4 Kamino      208.  83.1       31.5</span>
<span class="co">#&gt; # … with 6 more rows</span></code></pre></div>
<p>Because <code><a href="../reference/across.html">across()</a></code> is usually used in combination with <code><a href="../reference/summarise.html">summarise()</a></code> and <code><a href="../reference/mutate.html">mutate()</a></code>, it doesn’t select grouping variables in order to avoid accidentally modifying them:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>g <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">4</span>, <span class="op">-</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span>
<span class="va">df</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2 x 3</span>
<span class="co">#&gt;       g     x     y</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1     1     0    -5</span>
<span class="co">#&gt; 2     2     3    -9</span></code></pre></div>
<div id="multiple-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#multiple-functions" class="anchor"></a>Multiple functions</h3>
<p>You can transform each variable with more than one function by supplying a named list of functions or lambda functions in the second argument:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">min_max</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  min <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">.x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, 
  max <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">.x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">starwars</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">min_max</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 6</span>
<span class="co">#&gt;   height_min height_max mass_min mass_max birth_year_min birth_year_max</span>
<span class="co">#&gt;        &lt;int&gt;      &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;</span>
<span class="co">#&gt; 1         66        264       15     1358              8            896</span>
<span class="va">starwars</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">height</span>, <span class="va">mass</span>, <span class="va">birth_year</span><span class="op">)</span>, <span class="va">min_max</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 6</span>
<span class="co">#&gt;   height_min height_max mass_min mass_max birth_year_min birth_year_max</span>
<span class="co">#&gt;        &lt;int&gt;      &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;</span>
<span class="co">#&gt; 1         66        264       15     1358              8            896</span></code></pre></div>
<p>Control how the names are created with the <code>.names</code> argument which takes a <a href="https://glue.tidyverse.org/" class="external-link">glue</a> spec:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">starwars</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">min_max</span>, .names <span class="op">=</span> <span class="st">"{.fn}.{.col}"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 6</span>
<span class="co">#&gt;   min.height max.height min.mass max.mass min.birth_year max.birth_year</span>
<span class="co">#&gt;        &lt;int&gt;      &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;</span>
<span class="co">#&gt; 1         66        264       15     1358              8            896</span>
<span class="va">starwars</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">height</span>, <span class="va">mass</span>, <span class="va">birth_year</span><span class="op">)</span>, <span class="va">min_max</span>, .names <span class="op">=</span> <span class="st">"{.fn}.{.col}"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 6</span>
<span class="co">#&gt;   min.height max.height min.mass max.mass min.birth_year max.birth_year</span>
<span class="co">#&gt;        &lt;int&gt;      &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;</span>
<span class="co">#&gt; 1         66        264       15     1358              8            896</span></code></pre></div>
<p>If you’d prefer all summaries with the same function to be grouped together, you’ll have to expand the calls yourself:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">starwars</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/summarise.html">summarise</a></span><span class="op">(</span>
  <span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">height</span>, <span class="va">mass</span>, <span class="va">birth_year</span><span class="op">)</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">.x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, .names <span class="op">=</span> <span class="st">"min_{.col}"</span><span class="op">)</span>,
  <span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">height</span>, <span class="va">mass</span>, <span class="va">birth_year</span><span class="op">)</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">.x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, .names <span class="op">=</span> <span class="st">"max_{.col}"</span><span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 6</span>
<span class="co">#&gt;   min_height min_mass min_birth_year max_height max_mass max_birth_year</span>
<span class="co">#&gt;        &lt;int&gt;    &lt;dbl&gt;          &lt;dbl&gt;      &lt;int&gt;    &lt;dbl&gt;          &lt;dbl&gt;</span>
<span class="co">#&gt; 1         66       15              8        264     1358            896</span></code></pre></div>
<p>(One day this might become an argument to <code><a href="../reference/across.html">across()</a></code> but we’re not yet sure how it would work.)</p>
<p>We cannot however use <code>where(is.numeric)</code> in that last case because the second <code><a href="../reference/across.html">across()</a></code> would pick up the variables that were newly created (“min_height”, “min_mass” and “min_birth_year”).</p>
<p>We can work around this by combining both calls to <code><a href="../reference/across.html">across()</a></code> into a single expression that returns a tibble:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">starwars</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/summarise.html">summarise</a></span><span class="op">(</span>
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>
    <span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">.x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, .names <span class="op">=</span> <span class="st">"min_{.col}"</span><span class="op">)</span>,
    <span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">.x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, .names <span class="op">=</span> <span class="st">"max_{.col}"</span><span class="op">)</span>  
  <span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 6</span>
<span class="co">#&gt;   min_height min_mass min_birth_year max_height max_mass max_birth_year</span>
<span class="co">#&gt;        &lt;int&gt;    &lt;dbl&gt;          &lt;dbl&gt;      &lt;int&gt;    &lt;dbl&gt;          &lt;dbl&gt;</span>
<span class="co">#&gt; 1         66       15              8        264     1358            896</span></code></pre></div>
<p>Alternatively we could reorganize results with <code><a href="../reference/relocate.html">relocate()</a></code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">starwars</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">min_max</span>, .names <span class="op">=</span> <span class="st">"{.fn}.{.col}"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/relocate.html">relocate</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"min"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 6</span>
<span class="co">#&gt;   min.height min.mass min.birth_year max.height max.mass max.birth_year</span>
<span class="co">#&gt;        &lt;int&gt;    &lt;dbl&gt;          &lt;dbl&gt;      &lt;int&gt;    &lt;dbl&gt;          &lt;dbl&gt;</span>
<span class="co">#&gt; 1         66       15              8        264     1358            896</span></code></pre></div>
</div>
<div id="current-column" class="section level3">
<h3 class="hasAnchor">
<a href="#current-column" class="anchor"></a>Current column</h3>
<p>If you need to, you can access the name of the “current” column inside by calling <code><a href="../reference/context.html">cur_column()</a></code>. This can be useful if you want to perform some sort of context dependent transformation that’s already encoded in a vector:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, y <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">5</span>, z <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>
<span class="va">mult</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">10</span>, z <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>

<span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mult</span><span class="op">)</span><span class="op">)</span>, <span class="op">~</span> <span class="va">.x</span> <span class="op">*</span> <span class="va">mult</span><span class="op">[[</span><span class="fu"><a href="../reference/context.html">cur_column</a></span><span class="op">(</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 3 x 3</span>
<span class="co">#&gt;       x     y     z</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1     1    30   500</span>
<span class="co">#&gt; 2     2    40   600</span>
<span class="co">#&gt; 3     3    50   700</span></code></pre></div>
</div>
<div id="gotchas" class="section level3">
<h3 class="hasAnchor">
<a href="#gotchas" class="anchor"></a>Gotchas</h3>
<p>Be careful when combining numeric summaries with <code>where(is.numeric)</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">9</span><span class="op">)</span><span class="op">)</span>

<span class="va">df</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/summarise.html">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="../reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">sd</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;    n x        y</span>
<span class="co">#&gt; 1 NA 1 4.041452</span></code></pre></div>
<p>Here <code>n</code> becomes <code>NA</code> because <code>n</code> is numeric, so the <code><a href="../reference/across.html">across()</a></code> computes its standard deviation, and the standard deviation of 3 (a constant) is <code>NA</code>. You probably want to compute <code><a href="../reference/context.html">n()</a></code> last to avoid this problem:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">sd</span><span class="op">)</span>, n <span class="op">=</span> <span class="fu"><a href="../reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;   x        y n</span>
<span class="co">#&gt; 1 1 4.041452 3</span></code></pre></div>
<p>Alternatively, you could explicitly exclude <code>n</code> from the columns to operate on:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/summarise.html">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="../reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">n</span>, <span class="va">sd</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;   n x        y</span>
<span class="co">#&gt; 1 3 1 4.041452</span></code></pre></div>
<p>Another approach is to combine both the call to <code><a href="../reference/context.html">n()</a></code> and <code><a href="../reference/across.html">across()</a></code> in a single expression that returns a tibble:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/summarise.html">summarise</a></span><span class="op">(</span>
    <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="../reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">sd</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>
<span class="co">#&gt;   n x        y</span>
<span class="co">#&gt; 1 3 1 4.041452</span></code></pre></div>
</div>
<div id="other-verbs" class="section level3">
<h3 class="hasAnchor">
<a href="#other-verbs" class="anchor"></a>Other verbs</h3>
<p>So far we’ve focused on the use of <code><a href="../reference/across.html">across()</a></code> with <code><a href="../reference/summarise.html">summarise()</a></code>, but it works with any other dplyr verb that uses data masking:</p>
<ul>
<li>
<p>Rescale all numeric variables to range 0-1:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rescale01</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">rng</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">rng</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">rng</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">rng</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">rescale01</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 4 x 2</span>
<span class="co">#&gt;       x     y</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 0     0.385</span>
<span class="co">#&gt; 2 0.333 1    </span>
<span class="co">#&gt; 3 0.667 0    </span>
<span class="co">#&gt; 4 1     0.903</span></code></pre></div>
</li>
</ul>
<p>For some verbs, like <code><a href="../reference/group_by.html">group_by()</a></code>, <code><a href="../reference/count.html">count()</a></code> and <code><a href="../reference/distinct.html">distinct()</a></code>, you can omit the summary functions:</p>
<ul>
<li>
<p>Find all distinct</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">starwars</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/distinct.html">distinct</a></span><span class="op">(</span><span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"color"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 67 x 3</span>
<span class="co">#&gt;   hair_color skin_color  eye_color</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;    </span>
<span class="co">#&gt; 1 blond      fair        blue     </span>
<span class="co">#&gt; 2 &lt;NA&gt;       gold        yellow   </span>
<span class="co">#&gt; 3 &lt;NA&gt;       white, blue red      </span>
<span class="co">#&gt; 4 none       white       yellow   </span>
<span class="co">#&gt; # … with 63 more rows</span></code></pre></div>
</li>
<li>
<p>Count all combinations of variables with a given pattern:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">starwars</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/count.html">count</a></span><span class="op">(</span><span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"color"</span><span class="op">)</span><span class="op">)</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 67 x 4</span>
<span class="co">#&gt;   hair_color skin_color eye_color     n</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;     &lt;int&gt;</span>
<span class="co">#&gt; 1 brown      light      brown         6</span>
<span class="co">#&gt; 2 brown      fair       blue          4</span>
<span class="co">#&gt; 3 none       grey       black         4</span>
<span class="co">#&gt; 4 black      dark       brown         3</span>
<span class="co">#&gt; # … with 63 more rows</span></code></pre></div>
</li>
</ul>
<p><code><a href="../reference/across.html">across()</a></code> doesn’t work with <code><a href="../reference/select.html">select()</a></code> or <code><a href="../reference/rename.html">rename()</a></code> because they already use tidy select syntax; if you want to transform column names with a function, you can use <code><a href="../reference/rename.html">rename_with()</a></code>.</p>
</div>
<div id="filter" class="section level3">
<h3 class="hasAnchor">
<a href="#filter" class="anchor"></a>filter()</h3>
<p>We cannot directly use <code><a href="../reference/across.html">across()</a></code> in <code><a href="../reference/filter.html">filter()</a></code> because we need an extra step to combine the results. To that end, <code><a href="../reference/filter.html">filter()</a></code> has two special purpose companion functions:</p>
<ul>
<li>
<code><a href="../reference/across.html">if_any()</a></code> keeps the rows where the predicate is true for <em>at least one</em> selected column:</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">starwars</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="../reference/across.html">if_any</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="op">~</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 87 x 14</span>
<span class="co">#&gt;   name     height  mass hair_color skin_color  eye_color birth_year sex   gender</span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; </span>
<span class="co">#&gt; 1 Luke Sk…    172    77 blond      fair        blue            19   male  mascu…</span>
<span class="co">#&gt; 2 C-3PO       167    75 &lt;NA&gt;       gold        yellow         112   none  mascu…</span>
<span class="co">#&gt; 3 R2-D2        96    32 &lt;NA&gt;       white, blue red             33   none  mascu…</span>
<span class="co">#&gt; 4 Darth V…    202   136 none       white       yellow          41.9 male  mascu…</span>
<span class="co">#&gt; # … with 83 more rows, and 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;,</span>
<span class="co">#&gt; #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</span></code></pre></div>
<ul>
<li>
<code><a href="../reference/across.html">if_all()</a></code> keeps the rows where the predicate is true for <em>all</em> selected columns:</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">starwars</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="../reference/across.html">if_all</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="op">~</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 29 x 14</span>
<span class="co">#&gt;   name     height  mass hair_color  skin_color eye_color birth_year sex   gender</span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; </span>
<span class="co">#&gt; 1 Luke Sk…    172    77 blond       fair       blue            19   male  mascu…</span>
<span class="co">#&gt; 2 Darth V…    202   136 none        white      yellow          41.9 male  mascu…</span>
<span class="co">#&gt; 3 Leia Or…    150    49 brown       light      brown           19   fema… femin…</span>
<span class="co">#&gt; 4 Owen La…    178   120 brown, grey light      blue            52   male  mascu…</span>
<span class="co">#&gt; # … with 25 more rows, and 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;,</span>
<span class="co">#&gt; #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</span></code></pre></div>
<ul>
<li>
<p>Find all rows where no variable has missing values:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">starwars</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="op">~</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 29 x 14</span>
<span class="co">#&gt;   name     height  mass hair_color  skin_color eye_color birth_year sex   gender</span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; </span>
<span class="co">#&gt; 1 Luke Sk…    172    77 blond       fair       blue            19   male  mascu…</span>
<span class="co">#&gt; 2 Darth V…    202   136 none        white      yellow          41.9 male  mascu…</span>
<span class="co">#&gt; 3 Leia Or…    150    49 brown       light      brown           19   fema… femin…</span>
<span class="co">#&gt; 4 Owen La…    178   120 brown, grey light      blue            52   male  mascu…</span>
<span class="co">#&gt; # … with 25 more rows, and 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;,</span>
<span class="co">#&gt; #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</span></code></pre></div>
</li>
</ul>
</div>
</div>
<div id="if-_at-_all" class="section level2">
<h2 class="hasAnchor">
<a href="#if-_at-_all" class="anchor"></a><code>_if</code>, <code>_at</code>, <code>_all</code>
</h2>
<p>Prior versions of dplyr allowed you to apply a function to multiple columns in a different way: using functions with <code>_if</code>, <code>_at</code>, and <code>_all()</code> suffixes. These functions solved a pressing need and are used by many people, but are now superseded. That means that they’ll stay around, but won’t receive any new features and will only get critical bug fixes.</p>
<div id="why-do-we-like-across" class="section level3">
<h3 class="hasAnchor">
<a href="#why-do-we-like-across" class="anchor"></a>Why do we like <code>across()</code>?</h3>
<p>Why did we decide to move away from these functions in favour of <code><a href="../reference/across.html">across()</a></code>?</p>
<ol style="list-style-type: decimal">
<li>
<p><code><a href="../reference/across.html">across()</a></code> makes it possible to express useful summaries that were previously impossible:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/summarise.html">summarise</a></span><span class="op">(</span>
    <span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span>, 
    <span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.factor</span><span class="op">)</span>, <span class="va">nlevels</span><span class="op">)</span>,
    n <span class="op">=</span> <span class="fu"><a href="../reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, 
  <span class="op">)</span></code></pre></div>
</li>
<li><p><code><a href="../reference/across.html">across()</a></code> reduces the number of functions that dplyr needs to provide. This makes dplyr easier for you to use (because there are fewer functions to remember) and easier for us to implement new verbs (since we only need to implement one function, not four).</p></li>
<li><p><code><a href="../reference/across.html">across()</a></code> unifies <code>_if</code> and <code>_at</code> semantics so that you can select by position, name, and type, and you can now create compound selections that were previously impossible. For example, you can now transform all numeric columns whose name begins with “x”: <code><a href="../reference/across.html">across(where(is.numeric) &amp; starts_with("x"))</a></code>.</p></li>
<li><p><code><a href="../reference/across.html">across()</a></code> doesn’t need to use <code><a href="../reference/vars.html">vars()</a></code>. The <code>_at()</code> functions are the only place in dplyr where you have to manually quote variable names, which makes them a little weird and hence harder to remember.</p></li>
</ol>
</div>
<div id="why-did-it-take-so-long-to-discover-across" class="section level3">
<h3 class="hasAnchor">
<a href="#why-did-it-take-so-long-to-discover-across" class="anchor"></a>Why did it take so long to discover <code>across()</code>?</h3>
<p>It’s disappointing that we didn’t discover <code><a href="../reference/across.html">across()</a></code> earlier, and instead worked through several false starts (first not realising that it was a common problem, then with the <code>_each()</code> functions, and most recently with the <code>_if()</code>/<code>_at()</code>/<code>_all()</code> functions). But <code><a href="../reference/across.html">across()</a></code> couldn’t work without three recent discoveries:</p>
<ul>
<li><p>You can have a column of a data frame that is itself a data frame. This is something provided by base R, but it’s not very well documented, and it took a while to see that it was useful, not just a theoretical curiosity.</p></li>
<li><p>We can use data frames to allow summary functions to return multiple columns.</p></li>
<li><p>We can use the absence of an outer name as a convention that you want to unpack a data frame column into individual columns.</p></li>
</ul>
</div>
<div id="how-do-you-convert-existing-code" class="section level3">
<h3 class="hasAnchor">
<a href="#how-do-you-convert-existing-code" class="anchor"></a>How do you convert existing code?</h3>
<p>Fortunately, it’s generally straightforward to translate your existing code to use <code><a href="../reference/across.html">across()</a></code>:</p>
<ul>
<li><p>Strip the <code>_if()</code>, <code>_at()</code> and <code>_all()</code> suffix off the function.</p></li>
<li>
<p>Call <code><a href="../reference/across.html">across()</a></code>. The first argument will be:</p>
<ol style="list-style-type: decimal">
<li>For <code>_if()</code>, the old second argument wrapped in <code>where()</code>.</li>
<li>For <code>_at()</code>, the old second argument, with the call to <code><a href="../reference/vars.html">vars()</a></code> removed.</li>
<li>For <code>_all()</code>, <code><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything()</a></code>.</li>
</ol>
<p>The subsequent arguments can be copied as is.</p>
</li>
</ul>
<p>For example:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/mutate_all.html">mutate_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co"># -&gt;</span>
<span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>

<span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/mutate_all.html">mutate_at</a></span><span class="op">(</span><span class="fu"><a href="../reference/vars.html">vars</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"y"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span>
<span class="co"># -&gt;</span>
<span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"y"</span><span class="op">)</span><span class="op">)</span>, <span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>

<span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/mutate_all.html">mutate_all</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span>
<span class="co"># -&gt;</span>
<span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>There are a few exceptions to this rule:</p>
<ul>
<li><p><code>rename_*()</code> and <code>select_*()</code> follow a different pattern. They already have select semantics, so are generally used in a different way that doesn’t have a direct equivalent with <code><a href="../reference/across.html">across()</a></code>; use the new <code><a href="../reference/rename.html">rename_with()</a></code> instead.</p></li>
<li>
<p>Previously, <code>filter_*()</code> were paired with the <code><a href="../reference/all_vars.html">all_vars()</a></code> and <code><a href="../reference/all_vars.html">any_vars()</a></code> helpers. The new helpers <code><a href="../reference/across.html">if_any()</a></code> and <code><a href="../reference/across.html">if_all()</a></code> can be used inside <code><a href="../reference/filter.html">filter()</a></code> to keep rows for which the predicate is true for at least one, or all selected columns:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Find all rows where EVERY numeric variable is greater than zero</span>
<span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="../reference/across.html">if_all</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="op">~</span> <span class="va">.x</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 3</span>
<span class="co">#&gt;   x         y     z</span>
<span class="co">#&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 b         1     1</span>

<span class="co"># Find all rows where ANY numeric variable is greater than zero</span>
<span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="../reference/across.html">if_any</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="op">~</span> <span class="va">.x</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2 x 3</span>
<span class="co">#&gt;   x         y     z</span>
<span class="co">#&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 a         1    -1</span>
<span class="co">#&gt; 2 b         1     1</span></code></pre></div>
</li>
<li>
<p>When used in a <code><a href="../reference/mutate.html">mutate()</a></code>, all transformations performed by an <code><a href="../reference/across.html">across()</a></code> are applied at once. This is different to the behaviour of <code><a href="../reference/mutate_all.html">mutate_if()</a></code>, <code><a href="../reference/mutate_all.html">mutate_at()</a></code>, and <code><a href="../reference/mutate_all.html">mutate_all()</a></code>, which apply the transformations one at a time. We expect that you’ll generally find the new behaviour less surprising:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">2</span>, y <span class="op">=</span> <span class="fl">4</span>, z <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>
<span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/mutate_all.html">mutate_all</a></span><span class="op">(</span><span class="op">~</span> <span class="va">.x</span> <span class="op">/</span> <span class="va">y</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 3</span>
<span class="co">#&gt;       x     y     z</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1   0.5     1     8</span>

<span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="../reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="op">~</span> <span class="va">.x</span> <span class="op">/</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 3</span>
<span class="co">#&gt;       x     y     z</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1   0.5     1     2</span></code></pre></div>
</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="tidyverse">
  <p></p>
<p>Developed by <a href="http://hadley.nz" class="external-link external-link">Hadley Wickham</a>, Romain François, Lionel Henry, <a href="http://krlmlr.info" class="external-link external-link">Kirill Müller</a>, <a href="https://www.rstudio.com" class="external-link external-link"><img src="https://www.tidyverse.org/rstudio-logo.svg" alt="RStudio" height="24"></a>.</p>,<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.6.1.9000.</p>
</div>

<div class="author">
  <p>
    Developed by <a href="http://hadley.nz" class="external-link">Hadley Wickham</a>, Romain François, Lionel Henry, <a href="http://krlmlr.info" class="external-link">Kirill Müller</a>, <a href="https://www.rstudio.com" class="external-link"><img src="https://www.tidyverse.org/rstudio-logo.svg" alt="RStudio" height="24"></a>.
    Site built by <a href="https://pkgdown.r-lib.org" class="external-link">pkgdown</a>.
  </p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '1270c4079b26a138795263974bbf302d',
    indexName: 'tidyverse',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
