<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Grouped data • dplyr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../tidyverse.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../tidyverse-2.css" rel="stylesheet">
<!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Grouped data">
<meta property="og:description" content='To unlock the full potential of dplyr, you need to understand how each verb interacts with grouping. This vignette shows you how to manipulate grouping, how each verb changes its behaviour when working with grouped data, and  how you can access data about the "current" group from within a verb.
'>
<meta property="og:image" content="https://dplyr.tidyverse.org/logo.png">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">dplyr</a>
        <div class="info hidden-xs hidden-sm">
          <span class="partof">part of the <a href="https://tidyverse.org">tidyverse</a></span>
          <span class="version version-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.8.99.9002</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/dplyr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/grouping.html">Grouped data</a>
    </li>
    <li>
      <a href="../articles/two-table.html">Two-table verbs</a>
    </li>
    <li>
      <a href="../articles/base.html">dplyr &lt;-&gt; base R</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Automation</li>
    <li>
      <a href="../articles/colwise.html">colwise operations</a>
    </li>
    <li>
      <a href="../articles/rowwise.html">rowwise operations</a>
    </li>
    <li>
      <a href="../articles/programming.html">Programming with dplyr</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/index.html">More...</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Releases</li>
    <li>
      <a href="https://www.tidyverse.org/articles/2019/10/dplyr-0-8-4/">Version 0.8.4</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2019/07/dplyr-0-8-3/">Version 0.8.3</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2019/06/dplyr-0-8-2/">Version 0.8.2</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2019/05/dplyr-0-8-1/">Version 0.8.1</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2019/02/dplyr-0-8-0/">Version 0.8.0</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2018/06/dplyr-0.7.5/">Version 0.7.5</a>
    </li>
    <li class="divider">
    <li>
      <a href="../news/index.html">Changelog</a>
    </li>
  </ul>
</li>
        <li>
  <a href="https://github.com/tidyverse/dplyr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Grouped data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/dplyr/blob/master/vignettes/grouping.Rmd"><code>vignettes/grouping.Rmd</code></a></small>
      <div class="hidden name"><code>grouping.Rmd</code></div>

    </div>

    
    
<p>dplyr verbs are particularly powerful when you apply them to grouped data frames (<code>grouped_df</code> objects). This vignette shows you:</p>
<ul>
<li><p>How to group, inspect, and ungroup with <code><a href="../reference/group_by.html">group_by()</a></code> and friends.</p></li>
<li><p>How individual dplyr verbs changes their behaviour when applied to grouped data frame.</p></li>
<li><p>How to access data about the “current” group from within a verb.</p></li>
</ul>
<p>We’ll start by loading dplyr:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)</pre></body></html></div>
<div id="group_by" class="section level2">
<h2 class="hasAnchor">
<a href="#group_by" class="anchor"></a><code>group_by()</code>
</h2>
<p>The most important grouping verb is <code><a href="../reference/group_by.html">group_by()</a></code>: it takes a data frame and one or more variables to group by:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">by_species</span> <span class="kw">&lt;-</span> <span class="no">starwars</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/group_by.html">group_by</a></span>(<span class="no">species</span>)
<span class="no">by_sex_gender</span> <span class="kw">&lt;-</span> <span class="no">starwars</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/group_by.html">group_by</a></span>(<span class="no">sex</span>, <span class="no">gender</span>)</pre></body></html></div>
<p>You can see the grouping when you print the data:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">by_species</span>
<span class="co">#&gt; # A tibble: 87 x 14</span>
<span class="co">#&gt; # Groups:   species [38]</span>
<span class="co">#&gt;   name  height  mass hair_color skin_color eye_color birth_year sex   gender</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; </span>
<span class="co">#&gt; 1 Luke…    172    77 blond      fair       blue            19   male  mascu…</span>
<span class="co">#&gt; 2 C-3PO    167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…</span>
<span class="co">#&gt; 3 R2-D2     96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…</span>
<span class="co">#&gt; 4 Dart…    202   136 none       white      yellow          41.9 male  mascu…</span>
<span class="co">#&gt; # … with 83 more rows, and 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;,</span>
<span class="co">#&gt; #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</span>
<span class="no">by_sex_gender</span>
<span class="co">#&gt; # A tibble: 87 x 14</span>
<span class="co">#&gt; # Groups:   sex, gender [6]</span>
<span class="co">#&gt;   name  height  mass hair_color skin_color eye_color birth_year sex   gender</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; </span>
<span class="co">#&gt; 1 Luke…    172    77 blond      fair       blue            19   male  mascu…</span>
<span class="co">#&gt; 2 C-3PO    167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…</span>
<span class="co">#&gt; 3 R2-D2     96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…</span>
<span class="co">#&gt; 4 Dart…    202   136 none       white      yellow          41.9 male  mascu…</span>
<span class="co">#&gt; # … with 83 more rows, and 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;,</span>
<span class="co">#&gt; #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</span></pre></body></html></div>
<p>Or use <code><a href="../reference/count.html">tally()</a></code> to count the number of rows in each group. The <code>sort</code> argument is useful if you want to see the largest groups up front.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">by_species</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/count.html">tally</a></span>()
<span class="co">#&gt; # A tibble: 38 x 2</span>
<span class="co">#&gt;   species      n</span>
<span class="co">#&gt; * &lt;chr&gt;    &lt;int&gt;</span>
<span class="co">#&gt; 1 Aleena       1</span>
<span class="co">#&gt; 2 Besalisk     1</span>
<span class="co">#&gt; 3 Cerean       1</span>
<span class="co">#&gt; 4 Chagrian     1</span>
<span class="co">#&gt; # … with 34 more rows</span>

<span class="no">by_sex_gender</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/count.html">tally</a></span>(<span class="kw">sort</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co">#&gt; # A tibble: 6 x 3</span>
<span class="co">#&gt; # Groups:   sex [5]</span>
<span class="co">#&gt;   sex    gender        n</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;     &lt;int&gt;</span>
<span class="co">#&gt; 1 male   masculine    60</span>
<span class="co">#&gt; 2 female feminine     16</span>
<span class="co">#&gt; 3 none   masculine     5</span>
<span class="co">#&gt; 4 &lt;NA&gt;   &lt;NA&gt;          4</span>
<span class="co">#&gt; # … with 2 more rows</span></pre></body></html></div>
<p>As well as grouping by existing variables, you can group by any function of existing variables. This is equivalent to performing a <code><a href="../reference/mutate.html">mutate()</a></code> <strong>before</strong> the <code><a href="../reference/group_by.html">group_by()</a></code>:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">bmi_breaks</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">18.5</span>, <span class="fl">25</span>, <span class="fl">30</span>, <span class="fl">Inf</span>)

<span class="no">starwars</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/group_by.html">group_by</a></span>(<span class="kw">bmi_cat</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span>(<span class="no">mass</span>/(<span class="no">height</span>/<span class="fl">100</span>)^<span class="fl">2</span>, <span class="kw">breaks</span><span class="kw">=</span><span class="no">bmi_breaks</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/count.html">tally</a></span>()
<span class="co">#&gt; # A tibble: 5 x 2</span>
<span class="co">#&gt;   bmi_cat       n</span>
<span class="co">#&gt; * &lt;fct&gt;     &lt;int&gt;</span>
<span class="co">#&gt; 1 (0,18.5]     10</span>
<span class="co">#&gt; 2 (18.5,25]    24</span>
<span class="co">#&gt; 3 (25,30]      13</span>
<span class="co">#&gt; 4 (30,Inf]     12</span>
<span class="co">#&gt; # … with 1 more row</span></pre></body></html></div>
</div>
<div id="group-metadata" class="section level2">
<h2 class="hasAnchor">
<a href="#group-metadata" class="anchor"></a>Group metadata</h2>
<p>You can see underlying group data with <code><a href="../reference/group_data.html">group_keys()</a></code>. It has one row for each group and one column for each grouping variable:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">by_species</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/group_data.html">group_keys</a></span>()
<span class="co">#&gt; # A tibble: 38 x 1</span>
<span class="co">#&gt;   species </span>
<span class="co">#&gt; * &lt;chr&gt;   </span>
<span class="co">#&gt; 1 Aleena  </span>
<span class="co">#&gt; 2 Besalisk</span>
<span class="co">#&gt; 3 Cerean  </span>
<span class="co">#&gt; 4 Chagrian</span>
<span class="co">#&gt; # … with 34 more rows</span>

<span class="no">by_sex_gender</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/group_data.html">group_keys</a></span>()
<span class="co">#&gt; # A tibble: 6 x 2</span>
<span class="co">#&gt;   sex            gender   </span>
<span class="co">#&gt; * &lt;chr&gt;          &lt;chr&gt;    </span>
<span class="co">#&gt; 1 female         feminine </span>
<span class="co">#&gt; 2 hermaphroditic masculine</span>
<span class="co">#&gt; 3 male           masculine</span>
<span class="co">#&gt; 4 none           feminine </span>
<span class="co">#&gt; # … with 2 more rows</span></pre></body></html></div>
<p>You can see which group each row belongs to with <code><a href="../reference/group_data.html">group_indices()</a></code>:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">by_species</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/group_data.html">group_indices</a></span>()
<span class="co">#&gt;  [1] 11  6  6 11 11 11 11  6 11 11 11 11 34 11 24 12 11 11 36 11 11  6 31 11 11</span>
<span class="co">#&gt; [26] 18 11 11  8 26 11 21 11 10 10 10 38 30  7 38 11 37 32 32 33 35 29 11  3 20</span>
<span class="co">#&gt; [51] 37 27 13 23 16  4 11 11 11  9 17 17 11 11 11 11  5  2 15 15 11  1  6 25 19</span>
<span class="co">#&gt; [76] 28 14 34 11 38 22 11 11 11  6 38 11</span></pre></body></html></div>
<p>And which rows each group contains with <code><a href="../reference/group_data.html">group_rows()</a></code>:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">by_species</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/group_data.html">group_rows</a></span>() <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>()
<span class="co">#&gt; &lt;list_of&lt;integer&gt;[6]&gt;</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] 72</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1] 68</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1] 49</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt; [1] 56</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[5]]</span>
<span class="co">#&gt; [1] 67</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[6]]</span>
<span class="co">#&gt; [1]  2  3  8 22 73 85</span></pre></body></html></div>
<p>Use <code><a href="../reference/group_data.html">group_vars()</a></code> if you just want the names of the grouping variables:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">by_species</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/group_data.html">group_vars</a></span>()
<span class="co">#&gt; [1] "species"</span>
<span class="no">by_sex_gender</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/group_data.html">group_vars</a></span>()
<span class="co">#&gt; [1] "sex"    "gender"</span></pre></body></html></div>
<div id="changing-and-adding-to-grouping-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#changing-and-adding-to-grouping-variables" class="anchor"></a>Changing and adding to grouping variables</h3>
<p>If you apply <code><a href="../reference/group_by.html">group_by()</a></code> to an already grouped dataset, will overwrite the existing grouping variables. For example, the following code groups by <code>homeworld</code> instead of <code>species</code>:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">by_species</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/group_by.html">group_by</a></span>(<span class="no">homeworld</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/count.html">tally</a></span>()
<span class="co">#&gt; # A tibble: 49 x 2</span>
<span class="co">#&gt;   homeworld       n</span>
<span class="co">#&gt; * &lt;chr&gt;       &lt;int&gt;</span>
<span class="co">#&gt; 1 Alderaan        3</span>
<span class="co">#&gt; 2 Aleen Minor     1</span>
<span class="co">#&gt; 3 Bespin          1</span>
<span class="co">#&gt; 4 Bestine IV      1</span>
<span class="co">#&gt; # … with 45 more rows</span></pre></body></html></div>
<p>To <strong>augment</strong> the grouping, using <code>.add = TRUE</code><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. For example, the following code groups by species and homeworld:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">by_species</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/group_by.html">group_by</a></span>(<span class="no">homeworld</span>, <span class="kw">.add</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/count.html">tally</a></span>()
<span class="co">#&gt; # A tibble: 58 x 3</span>
<span class="co">#&gt; # Groups:   species [38]</span>
<span class="co">#&gt;   species  homeworld       n</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;       &lt;int&gt;</span>
<span class="co">#&gt; 1 Aleena   Aleen Minor     1</span>
<span class="co">#&gt; 2 Besalisk Ojom            1</span>
<span class="co">#&gt; 3 Cerean   Cerea           1</span>
<span class="co">#&gt; 4 Chagrian Champala        1</span>
<span class="co">#&gt; # … with 54 more rows</span></pre></body></html></div>
</div>
<div id="removing-grouping-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#removing-grouping-variables" class="anchor"></a>Removing grouping variables</h3>
<p>To remove all grouping variables, use <code><a href="../reference/group_by.html">ungroup()</a></code>:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">by_species</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/group_by.html">ungroup</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/count.html">tally</a></span>()
<span class="co">#&gt; # A tibble: 1 x 1</span>
<span class="co">#&gt;       n</span>
<span class="co">#&gt;   &lt;int&gt;</span>
<span class="co">#&gt; 1    87</span></pre></body></html></div>
<p>You can also choose to selectively ungroup by listing the variables you want to remove:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">by_sex_gender</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/group_by.html">ungroup</a></span>(<span class="no">sex</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/count.html">tally</a></span>()
<span class="co">#&gt; # A tibble: 3 x 2</span>
<span class="co">#&gt;   gender        n</span>
<span class="co">#&gt; * &lt;chr&gt;     &lt;int&gt;</span>
<span class="co">#&gt; 1 feminine     17</span>
<span class="co">#&gt; 2 masculine    66</span>
<span class="co">#&gt; 3 &lt;NA&gt;          4</span></pre></body></html></div>
</div>
</div>
<div id="verbs" class="section level2">
<h2 class="hasAnchor">
<a href="#verbs" class="anchor"></a>Verbs</h2>
<p>The following sections describe how grouping affects the main dplyr verbs.</p>
<div id="summarise" class="section level3">
<h3 class="hasAnchor">
<a href="#summarise" class="anchor"></a><code>summarise()</code>
</h3>
<p><code><a href="../reference/summarise.html">summarise()</a></code> computes a summary for each group. This means that it starts from <code><a href="../reference/group_data.html">group_keys()</a></code>, adding summary variables to the right hand side:</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">by_species</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/summarise.html">summarise</a></span>(
    <span class="kw">n</span> <span class="kw">=</span> <span class="fu"><a href="../reference/context.html">n</a></span>(),
    <span class="kw">height</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">height</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
  )
<span class="co">#&gt; # A tibble: 38 x 3</span>
<span class="co">#&gt;   species      n height</span>
<span class="co">#&gt; * &lt;chr&gt;    &lt;int&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Aleena       1     79</span>
<span class="co">#&gt; 2 Besalisk     1    198</span>
<span class="co">#&gt; 3 Cerean       1    198</span>
<span class="co">#&gt; 4 Chagrian     1    196</span>
<span class="co">#&gt; # … with 34 more rows</span></pre></body></html></div>
<p>For historical reasons, <code><a href="../reference/summarise.html">summarise()</a></code> removes the grouping variable on the right hand side:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">by_sex_gender</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/summarise.html">summarise</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fu"><a href="../reference/context.html">n</a></span>()) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/group_data.html">group_vars</a></span>()
<span class="co">#&gt; [1] "sex"</span></pre></body></html></div>
<p>If there’s only one grouping variable, the output will be ungrouped (i.e. a regular tibble).</p>
</div>
<div id="select-rename-and-relocate" class="section level3">
<h3 class="hasAnchor">
<a href="#select-rename-and-relocate" class="anchor"></a><code>select()</code>, <code>rename()</code>, and <code>relocate()</code>
</h3>
<p><code><a href="../reference/rename.html">rename()</a></code> and <code><a href="../reference/relocate.html">relocate()</a></code> behave identically with grouped and ungrouped data because they only affect the name or position of existing columns. Grouped <code><a href="../reference/select.html">select()</a></code> is almost identical to ungrouped select, except that it always includes the grouping variables:</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">by_species</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/select.html">select</a></span>(<span class="no">mass</span>)
<span class="co">#&gt; Adding missing grouping variables: `species`</span>
<span class="co">#&gt; # A tibble: 87 x 2</span>
<span class="co">#&gt; # Groups:   species [38]</span>
<span class="co">#&gt;   species  mass</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Human      77</span>
<span class="co">#&gt; 2 Droid      75</span>
<span class="co">#&gt; 3 Droid      32</span>
<span class="co">#&gt; 4 Human     136</span>
<span class="co">#&gt; # … with 83 more rows</span></pre></body></html></div>
<p>If you don’t want the grouping variables, you’ll have to first <code><a href="../reference/group_by.html">ungroup()</a></code>. (This design is possibly a mistake, but we’re stuck with it for now.)</p>
</div>
<div id="arrange" class="section level3">
<h3 class="hasAnchor">
<a href="#arrange" class="anchor"></a><code>arrange()</code>
</h3>
<p>Grouped <code><a href="../reference/arrange.html">arrange()</a></code> is the same as ungrouped <code><a href="../reference/arrange.html">arrange()</a></code>, unless you set <code>.by_group = TRUE</code>, in which case it will order first by the grouping variables.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">by_species</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/arrange.html">arrange</a></span>(<span class="fu"><a href="../reference/desc.html">desc</a></span>(<span class="no">mass</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/relocate.html">relocate</a></span>(<span class="no">species</span>, <span class="no">mass</span>)
<span class="co">#&gt; # A tibble: 87 x 14</span>
<span class="co">#&gt; # Groups:   species [38]</span>
<span class="co">#&gt;   species  mass name  height hair_color skin_color eye_color birth_year sex  </span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1 Hutt     1358 Jabb…    175 &lt;NA&gt;       green-tan… orange         600   herm…</span>
<span class="co">#&gt; 2 Kaleesh   159 Grie…    216 none       brown, wh… green, y…       NA   male </span>
<span class="co">#&gt; 3 Droid     140 IG-88    200 none       metal      red             15   none </span>
<span class="co">#&gt; 4 Human     136 Dart…    202 none       white      yellow          41.9 male </span>
<span class="co">#&gt; # … with 83 more rows, and 5 more variables: gender &lt;chr&gt;, homeworld &lt;chr&gt;,</span>
<span class="co">#&gt; #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</span>

<span class="no">by_species</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/arrange.html">arrange</a></span>(<span class="fu"><a href="../reference/desc.html">desc</a></span>(<span class="no">mass</span>), <span class="kw">.by_group</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/relocate.html">relocate</a></span>(<span class="no">species</span>, <span class="no">mass</span>)
<span class="co">#&gt; # A tibble: 87 x 14</span>
<span class="co">#&gt; # Groups:   species [38]</span>
<span class="co">#&gt;   species  mass name  height hair_color skin_color eye_color birth_year sex  </span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1 Aleena     15 Ratt…     79 none       grey, blue unknown           NA male </span>
<span class="co">#&gt; 2 Besali…   102 Dext…    198 none       brown      yellow            NA male </span>
<span class="co">#&gt; 3 Cerean     82 Ki-A…    198 white      pale       yellow            92 male </span>
<span class="co">#&gt; 4 Chagri…    NA Mas …    196 none       blue       blue              NA male </span>
<span class="co">#&gt; # … with 83 more rows, and 5 more variables: gender &lt;chr&gt;, homeworld &lt;chr&gt;,</span>
<span class="co">#&gt; #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</span></pre></body></html></div>
<p>Note that second example is sorted by <code>species</code> (from the <code><a href="../reference/group_by.html">group_by()</a></code> statement) and then by <code>mass</code> (within species).</p>
</div>
<div id="mutate-and-transmute" class="section level3">
<h3 class="hasAnchor">
<a href="#mutate-and-transmute" class="anchor"></a><code>mutate()</code> and <code>transmute()</code>
</h3>
<p>In simple cases with vectorised functions, grouped and ungrouped <code><a href="../reference/mutate.html">mutate()</a></code> give the same results. They differ when used with summary functions:</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="co"># Subtract off global mean</span>
<span class="no">starwars</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/select.html">select</a></span>(<span class="no">name</span>, <span class="no">homeworld</span>, <span class="no">mass</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/mutate.html">mutate</a></span>(<span class="kw">standard_mass</span> <span class="kw">=</span> <span class="no">mass</span> - <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">mass</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>))
<span class="co">#&gt; # A tibble: 87 x 4</span>
<span class="co">#&gt;   name           homeworld  mass standard_mass</span>
<span class="co">#&gt;   &lt;chr&gt;          &lt;chr&gt;     &lt;dbl&gt;         &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Luke Skywalker Tatooine     77         -20.3</span>
<span class="co">#&gt; 2 C-3PO          Tatooine     75         -22.3</span>
<span class="co">#&gt; 3 R2-D2          Naboo        32         -65.3</span>
<span class="co">#&gt; 4 Darth Vader    Tatooine    136          38.7</span>
<span class="co">#&gt; # … with 83 more rows</span>

<span class="co"># Subtract off homeworld mean</span>
<span class="no">starwars</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/select.html">select</a></span>(<span class="no">name</span>, <span class="no">homeworld</span>, <span class="no">mass</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/group_by.html">group_by</a></span>(<span class="no">homeworld</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/mutate.html">mutate</a></span>(<span class="kw">standard_mass</span> <span class="kw">=</span> <span class="no">mass</span> - <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">mass</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>))
<span class="co">#&gt; # A tibble: 87 x 4</span>
<span class="co">#&gt; # Groups:   homeworld [49]</span>
<span class="co">#&gt;   name           homeworld  mass standard_mass</span>
<span class="co">#&gt;   &lt;chr&gt;          &lt;chr&gt;     &lt;dbl&gt;         &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Luke Skywalker Tatooine     77         -8.38</span>
<span class="co">#&gt; 2 C-3PO          Tatooine     75        -10.4 </span>
<span class="co">#&gt; 3 R2-D2          Naboo        32        -32.2 </span>
<span class="co">#&gt; 4 Darth Vader    Tatooine    136         50.6 </span>
<span class="co">#&gt; # … with 83 more rows</span></pre></body></html></div>
<p>Or with window functions like <code><a href="../reference/ranking.html">min_rank()</a></code>:</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="co"># Overall rank</span>
<span class="no">starwars</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/select.html">select</a></span>(<span class="no">name</span>, <span class="no">homeworld</span>, <span class="no">height</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/mutate.html">mutate</a></span>(<span class="kw">rank</span> <span class="kw">=</span> <span class="fu"><a href="../reference/ranking.html">min_rank</a></span>(<span class="no">height</span>))
<span class="co">#&gt; # A tibble: 87 x 4</span>
<span class="co">#&gt;   name           homeworld height  rank</span>
<span class="co">#&gt;   &lt;chr&gt;          &lt;chr&gt;      &lt;int&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1 Luke Skywalker Tatooine     172    29</span>
<span class="co">#&gt; 2 C-3PO          Tatooine     167    21</span>
<span class="co">#&gt; 3 R2-D2          Naboo         96     5</span>
<span class="co">#&gt; 4 Darth Vader    Tatooine     202    72</span>
<span class="co">#&gt; # … with 83 more rows</span>

<span class="co"># Rank per homeworld</span>
<span class="no">starwars</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/select.html">select</a></span>(<span class="no">name</span>, <span class="no">homeworld</span>, <span class="no">height</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/group_by.html">group_by</a></span>(<span class="no">homeworld</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/mutate.html">mutate</a></span>(<span class="kw">rank</span> <span class="kw">=</span> <span class="fu"><a href="../reference/ranking.html">min_rank</a></span>(<span class="no">height</span>))
<span class="co">#&gt; # A tibble: 87 x 4</span>
<span class="co">#&gt; # Groups:   homeworld [49]</span>
<span class="co">#&gt;   name           homeworld height  rank</span>
<span class="co">#&gt;   &lt;chr&gt;          &lt;chr&gt;      &lt;int&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1 Luke Skywalker Tatooine     172     5</span>
<span class="co">#&gt; 2 C-3PO          Tatooine     167     4</span>
<span class="co">#&gt; 3 R2-D2          Naboo         96     1</span>
<span class="co">#&gt; 4 Darth Vader    Tatooine     202    10</span>
<span class="co">#&gt; # … with 83 more rows</span></pre></body></html></div>
</div>
<div id="filter" class="section level3">
<h3 class="hasAnchor">
<a href="#filter" class="anchor"></a><code>filter()</code>
</h3>
<p>A grouped <code><a href="../reference/filter.html">filter()</a></code> effectively does a <code><a href="../reference/mutate.html">mutate()</a></code> to generate a logical variable, and then only keeps the rows where the variable is <code>TRUE</code>. This means that grouped filters can be used with summary functions. For example, we can find the tallest character of each species:</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">by_species</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/select.html">select</a></span>(<span class="no">name</span>, <span class="no">species</span>, <span class="no">height</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/filter.html">filter</a></span>(<span class="no">height</span> <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">height</span>))
<span class="co">#&gt; # A tibble: 35 x 3</span>
<span class="co">#&gt; # Groups:   species [35]</span>
<span class="co">#&gt;   name                  species        height</span>
<span class="co">#&gt;   &lt;chr&gt;                 &lt;chr&gt;           &lt;int&gt;</span>
<span class="co">#&gt; 1 Greedo                Rodian            173</span>
<span class="co">#&gt; 2 Jabba Desilijic Tiure Hutt              175</span>
<span class="co">#&gt; 3 Yoda                  Yoda's species     66</span>
<span class="co">#&gt; 4 Bossk                 Trandoshan        190</span>
<span class="co">#&gt; # … with 31 more rows</span></pre></body></html></div>
<p>You can also use <code><a href="../reference/filter.html">filter()</a></code> to remove entire groups. For example, the following code eliminates all groups that only have a single member:</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">by_species</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/filter.html">filter</a></span>(<span class="fu"><a href="../reference/context.html">n</a></span>() <span class="kw">!=</span> <span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/count.html">tally</a></span>()
<span class="co">#&gt; # A tibble: 9 x 2</span>
<span class="co">#&gt;   species      n</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;int&gt;</span>
<span class="co">#&gt; 1 Droid        6</span>
<span class="co">#&gt; 2 Gungan       3</span>
<span class="co">#&gt; 3 Human       35</span>
<span class="co">#&gt; 4 Kaminoan     2</span>
<span class="co">#&gt; # … with 5 more rows</span></pre></body></html></div>
</div>
<div id="slice-and-friends" class="section level3">
<h3 class="hasAnchor">
<a href="#slice-and-friends" class="anchor"></a><code>slice()</code> and friends</h3>
<p><code><a href="../reference/slice.html">slice()</a></code> and friends (<code><a href="../reference/slice.html">slice_head()</a></code>, <code><a href="../reference/slice.html">slice_tail()</a></code>, <code><a href="../reference/slice.html">slice_sample()</a></code>, <code><a href="../reference/slice.html">slice_min()</a></code> and <code><a href="../reference/slice.html">slice_max()</a></code>) select rows within a group. For example, we can select the first observation within each species:</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="no">by_species</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/relocate.html">relocate</a></span>(<span class="no">species</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/slice.html">slice</a></span>(<span class="fl">1</span>)
<span class="co">#&gt; # A tibble: 38 x 14</span>
<span class="co">#&gt; # Groups:   species [38]</span>
<span class="co">#&gt;   species name  height  mass hair_color skin_color eye_color birth_year sex  </span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1 Aleena  Ratt…     79    15 none       grey, blue unknown           NA male </span>
<span class="co">#&gt; 2 Besali… Dext…    198   102 none       brown      yellow            NA male </span>
<span class="co">#&gt; 3 Cerean  Ki-A…    198    82 white      pale       yellow            92 male </span>
<span class="co">#&gt; 4 Chagri… Mas …    196    NA none       blue       blue              NA male </span>
<span class="co">#&gt; # … with 34 more rows, and 5 more variables: gender &lt;chr&gt;, homeworld &lt;chr&gt;,</span>
<span class="co">#&gt; #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</span></pre></body></html></div>
<p>Similarly, we can use <code><a href="../reference/slice.html">slice_min()</a></code> to select the smallest <code>n</code> values of a variable:</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="no">by_species</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/filter.html">filter</a></span>(!<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">height</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/slice.html">slice_min</a></span>(<span class="no">height</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="co">#&gt; # A tibble: 48 x 14</span>
<span class="co">#&gt; # Groups:   species [38]</span>
<span class="co">#&gt;   name  height  mass hair_color skin_color eye_color birth_year sex   gender</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; </span>
<span class="co">#&gt; 1 Ratt…     79    15 none       grey, blue unknown           NA male  mascu…</span>
<span class="co">#&gt; 2 Dext…    198   102 none       brown      yellow            NA male  mascu…</span>
<span class="co">#&gt; 3 Ki-A…    198    82 white      pale       yellow            92 male  mascu…</span>
<span class="co">#&gt; 4 Mas …    196    NA none       blue       blue              NA male  mascu…</span>
<span class="co">#&gt; # … with 44 more rows, and 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;,</span>
<span class="co">#&gt; #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</span></pre></body></html></div>
</div>
</div>
<div id="computing-on-grouping-information" class="section level2">
<h2 class="hasAnchor">
<a href="#computing-on-grouping-information" class="anchor"></a>Computing on grouping information</h2>
<p>Inside dplyr verbs, you can access various properties of the “current” group using a family of functions with the <code>cur_</code> prefix. These functions are typically needed for everyday usage of dplyr, but can be useful because they allow you to free from some of the typical constraints of dplyr verbs.</p>
<div id="cur_data" class="section level3">
<h3 class="hasAnchor">
<a href="#cur_data" class="anchor"></a><code>cur_data()</code>
</h3>
<p><code><a href="../reference/context.html">cur_data()</a></code> returns the current group, excluding grouping variables. It’s useful to feed to functions that take a whole data frame. For example, the following code fits a linear model of <code>mass ~ height</code> to each species:</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="no">by_species</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/filter.html">filter</a></span>(<span class="fu"><a href="../reference/context.html">n</a></span>() <span class="kw">&gt;</span> <span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/mutate.html">mutate</a></span>(<span class="kw">mod</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">mass</span> ~ <span class="no">height</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="fu"><a href="../reference/context.html">cur_data</a></span>())))
<span class="co">#&gt; # A tibble: 58 x 15</span>
<span class="co">#&gt; # Groups:   species [9]</span>
<span class="co">#&gt;   name  height  mass hair_color skin_color eye_color birth_year sex   gender</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; </span>
<span class="co">#&gt; 1 Luke…    172    77 blond      fair       blue            19   male  mascu…</span>
<span class="co">#&gt; 2 C-3PO    167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…</span>
<span class="co">#&gt; 3 R2-D2     96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…</span>
<span class="co">#&gt; 4 Dart…    202   136 none       white      yellow          41.9 male  mascu…</span>
<span class="co">#&gt; # … with 54 more rows, and 6 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;,</span>
<span class="co">#&gt; #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;, mod &lt;list&gt;</span></pre></body></html></div>
</div>
<div id="cur_group-and-cur_group_id" class="section level3">
<h3 class="hasAnchor">
<a href="#cur_group-and-cur_group_id" class="anchor"></a><code>cur_group()</code> and <code>cur_group_id()</code>
</h3>
<p><code><a href="../reference/context.html">cur_group_id()</a></code> gives a unique numeric identifier for the current group. This is sometimes useful if you want to index into an external data structure.</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="no">by_species</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/arrange.html">arrange</a></span>(<span class="no">species</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/select.html">select</a></span>(<span class="no">name</span>, <span class="no">species</span>, <span class="no">homeworld</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/mutate.html">mutate</a></span>(<span class="kw">id</span> <span class="kw">=</span> <span class="fu"><a href="../reference/context.html">cur_group_id</a></span>())
<span class="co">#&gt; # A tibble: 87 x 4</span>
<span class="co">#&gt; # Groups:   species [38]</span>
<span class="co">#&gt;   name            species  homeworld      id</span>
<span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;    &lt;chr&gt;       &lt;int&gt;</span>
<span class="co">#&gt; 1 Ratts Tyerell   Aleena   Aleen Minor     1</span>
<span class="co">#&gt; 2 Dexter Jettster Besalisk Ojom            2</span>
<span class="co">#&gt; 3 Ki-Adi-Mundi    Cerean   Cerea           3</span>
<span class="co">#&gt; 4 Mas Amedda      Chagrian Champala        4</span>
<span class="co">#&gt; # … with 83 more rows</span></pre></body></html></div>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Note that the argument changed from <code>add = TRUE</code> to <code>.add = TRUE</code> in dplyr 1.0.0.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="tidyverse">
  <p>dplyr is a part of the <strong>tidyverse</strong>, an ecosystem of packages designed with common APIs and a shared philosophy. Learn more at <a href="https://tidyverse.org">tidyverse.org</a>.</p>
</div>

<div class="author">
  <p>
    Developed by <a href="http://hadley.nz">Hadley Wickham</a>, Romain François, Lionel Henry, <a href="http://krlmlr.info">Kirill Müller</a>, <a href="https://www.rstudio.com"><img src="https://www.tidyverse.org/rstudio-logo.svg" alt="RStudio" height="24"></a>.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '1270c4079b26a138795263974bbf302d',
    indexName: 'tidyverse',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
