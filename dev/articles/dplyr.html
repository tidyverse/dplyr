<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to dplyr • dplyr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../tidyverse.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../tidyverse-2.css" rel="stylesheet">
<!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Introduction to dplyr">
<meta property="og:description" content="dplyr">
<meta property="og:image" content="https://dplyr.tidyverse.org/logo.png">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">dplyr</a>
        <div class="info">
          <span class="partof">part of the <a href="https://tidyverse.org">tidyverse</a></span>
          <span class="version version-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.8.99.9002</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/dplyr.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/two-table.html">Two-table verbs</a>
    </li>
    <li>
      <a href="../articles/window-functions.html">Window functions</a>
    </li>
    <li>
      <a href="http://dbplyr.tidyverse.org/articles/dbplyr.html">Databases with dbplyr</a>
    </li>
    <li>
      <a href="../articles/programming.html">Programming with dplyr</a>
    </li>
    <li>
      <a href="../articles/compatibility.html">Compatibility</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Release notes</li>
    <li>
      <a href="https://www.tidyverse.org/articles/2019/10/dplyr-0-8-4/">Version 0.8.4</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2019/07/dplyr-0-8-3/">Version 0.8.3</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2019/06/dplyr-0-8-2/">Version 0.8.2</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2019/05/dplyr-0-8-1/">Version 0.8.1</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2019/02/dplyr-0-8-0/">Version 0.8.0</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2018/06/dplyr-0.7.5/">Version 0.7.5</a>
    </li>
    <li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
        <li>
  <a href="https://github.com/tidyverse/dplyr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to dplyr</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/dplyr/blob/master/vignettes/dplyr.Rmd"><code>vignettes/dplyr.Rmd</code></a></small>
      <div class="hidden name"><code>dplyr.Rmd</code></div>

    </div>

    
    
<p>When working with data you must:</p>
<ul>
<li><p>Figure out what you want to do.</p></li>
<li><p>Describe those tasks in the form of a computer program.</p></li>
<li><p>Execute the program.</p></li>
</ul>
<p>The dplyr package makes these steps fast and easy:</p>
<ul>
<li><p>By constraining your options, it helps you think about your data manipulation challenges.</p></li>
<li><p>It provides simple “verbs”, functions that correspond to the most common data manipulation tasks, to help you translate your thoughts into code.</p></li>
<li><p>It uses efficient backends, so you spend less time waiting for the computer.</p></li>
</ul>
<p>This document introduces you to dplyr’s basic set of tools, and shows you how to apply them to data frames. dplyr also supports databases via the dbplyr package, once you’ve installed, read <code>vignette("dbplyr")</code> to learn more.</p>
<p>All of the dplyr functions take a data frame (or tibble) as the first argument. Rather than forcing the user to either save intermediate objects or nest functions, dplyr provides the <code><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></code> operator from magrittr. <code>x %&gt;% f(y)</code> turns into <code>f(x, y)</code> so the result from one step is then “piped” into the next step. You can use the pipe to rewrite multiple operations that you can read left-to-right, top-to-bottom (reading the pipe operator as “then”).</p>
<div id="data-starwars" class="section level2">
<h2 class="hasAnchor">
<a href="#data-starwars" class="anchor"></a>Data: starwars</h2>
<p>To explore the basic data manipulation verbs of dplyr, we’ll use the dataset <code>starwars</code>. This dataset contains 87 characters and comes from the <a href="http://swapi.co">Star Wars API</a>, and is documented in <code><a href="../reference/starwars.html">?starwars</a></code></p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="no">starwars</span>)
<span class="co">#&gt; [1] 87 14</span>
<span class="no">starwars</span>
<span class="co">#&gt; # A tibble: 87 x 14</span>
<span class="co">#&gt;   name  height  mass hair_color skin_color eye_color birth_year sex   gender</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; </span>
<span class="co">#&gt; 1 Luke…    172    77 blond      fair       blue            19   male  mascu…</span>
<span class="co">#&gt; 2 C-3PO    167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…</span>
<span class="co">#&gt; 3 R2-D2     96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…</span>
<span class="co">#&gt; 4 Dart…    202   136 none       white      yellow          41.9 male  mascu…</span>
<span class="co">#&gt; # … with 83 more rows, and 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;,</span>
<span class="co">#&gt; #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</span></pre></body></html></div>
<p>Note that <code>starwars</code> is a tibble, a modern reimagining of the data frame. It’s particularly useful for large datasets because it only prints the first few rows. You can learn more about tibbles at <a href="http://tibble.tidyverse.org" class="uri">http://tibble.tidyverse.org</a>; in particular you can convert data frames to tibbles with <code><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble()</a></code>.</p>
</div>
<div id="single-table-verbs" class="section level2">
<h2 class="hasAnchor">
<a href="#single-table-verbs" class="anchor"></a>Single table verbs</h2>
<p>dplyr aims to provide a function for each basic verb of data manipulation.</p>
<ul>
<li>
<p>row operations:</p>
<ul>
<li>
<code><a href="../reference/filter.html">filter()</a></code> to choose cases based on their values.</li>
<li>
<code><a href="../reference/arrange.html">arrange()</a></code> to reorder the cases.</li>
<li>
<code><a href="../reference/slice.html">slice()</a></code> to choose cases based on their position.</li>
</ul>
</li>
<li>
<p>column operations:</p>
<ul>
<li>
<code><a href="../reference/select.html">select()</a></code> and <code><a href="../reference/rename.html">rename()</a></code> to select variables based on their names.</li>
<li>
<code><a href="../reference/mutate.html">mutate()</a></code> and <code><a href="../reference/mutate.html">transmute()</a></code> to add new variables that are functions of existing variables.</li>
<li>
<code><a href="../reference/relocate.html">relocate()</a></code> to change the order of the variables.</li>
</ul>
</li>
<li>
<p>summarize operation:</p>
<ul>
<li>
<code><a href="../reference/summarise.html">summarise()</a></code> to condense multiple values to a single value.</li>
</ul>
</li>
</ul>
<div id="filter-rows-with-filter" class="section level3">
<h3 class="hasAnchor">
<a href="#filter-rows-with-filter" class="anchor"></a>Filter rows with <code>filter()</code>
</h3>
<p><code><a href="../reference/filter.html">filter()</a></code> allows you to select a subset of rows in a data frame. Like all single verbs, the first argument is the tibble (or data frame). The second and subsequent arguments refer to variables within that data frame, selecting rows where the expression is <code>TRUE</code>.</p>
<p>For example, we can select all character with light skin color and brown eyes with:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">starwars</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/filter.html">filter</a></span>(<span class="no">skin_color</span> <span class="kw">==</span> <span class="st">"light"</span>, <span class="no">eye_color</span> <span class="kw">==</span> <span class="st">"brown"</span>)
<span class="co">#&gt; # A tibble: 7 x 14</span>
<span class="co">#&gt;   name  height  mass hair_color skin_color eye_color birth_year sex   gender</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; </span>
<span class="co">#&gt; 1 Leia…    150    49 brown      light      brown             19 fema… femin…</span>
<span class="co">#&gt; 2 Bigg…    183    84 black      light      brown             24 male  mascu…</span>
<span class="co">#&gt; 3 Cordé    157    NA brown      light      brown             NA fema… femin…</span>
<span class="co">#&gt; 4 Dormé    165    NA brown      light      brown             NA fema… femin…</span>
<span class="co">#&gt; # … with 3 more rows, and 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;,</span>
<span class="co">#&gt; #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</span></pre></body></html></div>
<p>This is rougly equivalent to this base R code:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">starwars</span>[<span class="no">starwars</span>$<span class="no">skin_color</span> <span class="kw">==</span> <span class="st">"light"</span> <span class="kw">&amp;</span> <span class="no">starwars</span>$<span class="no">eye_color</span> <span class="kw">==</span> <span class="st">"brown"</span>, ]</pre></body></html></div>
</div>
<div id="arrange-rows-with-arrange" class="section level3">
<h3 class="hasAnchor">
<a href="#arrange-rows-with-arrange" class="anchor"></a>Arrange rows with <code>arrange()</code>
</h3>
<p><code><a href="../reference/arrange.html">arrange()</a></code> works similarly to <code><a href="../reference/filter.html">filter()</a></code> except that instead of filtering or selecting rows, it reorders them. It takes a data frame, and a set of column names (or more complicated expressions) to order by. If you provide more than one column name, each additional column will be used to break ties in the values of preceding columns:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">starwars</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/arrange.html">arrange</a></span>(<span class="no">height</span>, <span class="no">mass</span>)
<span class="co">#&gt; # A tibble: 87 x 14</span>
<span class="co">#&gt;   name  height  mass hair_color skin_color eye_color birth_year sex   gender</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; </span>
<span class="co">#&gt; 1 Yoda      66    17 white      green      brown            896 male  mascu…</span>
<span class="co">#&gt; 2 Ratt…     79    15 none       grey, blue unknown           NA male  mascu…</span>
<span class="co">#&gt; 3 Wick…     88    20 brown      brown      brown              8 male  mascu…</span>
<span class="co">#&gt; 4 Dud …     94    45 none       blue, grey yellow            NA male  mascu…</span>
<span class="co">#&gt; # … with 83 more rows, and 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;,</span>
<span class="co">#&gt; #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</span></pre></body></html></div>
<p>Use <code><a href="../reference/desc.html">desc()</a></code> to order a column in descending order:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">starwars</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/arrange.html">arrange</a></span>(<span class="fu"><a href="../reference/desc.html">desc</a></span>(<span class="no">height</span>))
<span class="co">#&gt; # A tibble: 87 x 14</span>
<span class="co">#&gt;   name  height  mass hair_color skin_color eye_color birth_year sex   gender</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; </span>
<span class="co">#&gt; 1 Yara…    264    NA none       white      yellow            NA male  mascu…</span>
<span class="co">#&gt; 2 Tarf…    234   136 brown      brown      blue              NA male  mascu…</span>
<span class="co">#&gt; 3 Lama…    229    88 none       grey       black             NA male  mascu…</span>
<span class="co">#&gt; 4 Chew…    228   112 brown      unknown    blue             200 male  mascu…</span>
<span class="co">#&gt; # … with 83 more rows, and 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;,</span>
<span class="co">#&gt; #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</span></pre></body></html></div>
</div>
<div id="choose-rows-using-their-position-with-slice" class="section level3">
<h3 class="hasAnchor">
<a href="#choose-rows-using-their-position-with-slice" class="anchor"></a>Choose rows using their position with <code>slice()</code>
</h3>
<p>slice() lets you index rows by their (integer) locations. It allows you to select, remove, and duplicate rows.</p>
<p>We can get characters from row numbers 5 through 10.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">starwars</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/slice.html">slice</a></span>(<span class="fl">5</span>:<span class="fl">10</span>)
<span class="co">#&gt; # A tibble: 6 x 14</span>
<span class="co">#&gt;   name  height  mass hair_color skin_color eye_color birth_year sex   gender</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; </span>
<span class="co">#&gt; 1 Leia…    150    49 brown      light      brown             19 fema… femin…</span>
<span class="co">#&gt; 2 Owen…    178   120 brown, gr… light      blue              52 male  mascu…</span>
<span class="co">#&gt; 3 Beru…    165    75 brown      light      blue              47 fema… femin…</span>
<span class="co">#&gt; 4 R5-D4     97    32 &lt;NA&gt;       white, red red               NA none  mascu…</span>
<span class="co">#&gt; # … with 2 more rows, and 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;,</span>
<span class="co">#&gt; #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</span></pre></body></html></div>
<p>It is accompanied by a number of helpers for common use cases:</p>
<ul>
<li>slice_head() and slice_tail() select the first or last rows.</li>
</ul>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">starwars</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/slice.html">slice_head</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="co">#&gt; # A tibble: 3 x 14</span>
<span class="co">#&gt;   name  height  mass hair_color skin_color eye_color birth_year sex   gender</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; </span>
<span class="co">#&gt; 1 Luke…    172    77 blond      fair       blue              19 male  mascu…</span>
<span class="co">#&gt; 2 C-3PO    167    75 &lt;NA&gt;       gold       yellow           112 none  mascu…</span>
<span class="co">#&gt; 3 R2-D2     96    32 &lt;NA&gt;       white, bl… red               33 none  mascu…</span>
<span class="co">#&gt; # … with 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,</span>
<span class="co">#&gt; #   vehicles &lt;list&gt;, starships &lt;list&gt;</span></pre></body></html></div>
<ul>
<li>slice_sample() randomly selects rows. Use the option prop to choose a certain proportion of the cases.</li>
</ul>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">starwars</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/slice.html">slice_sample</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">5</span>)
<span class="co">#&gt; # A tibble: 5 x 14</span>
<span class="co">#&gt;   name  height  mass hair_color skin_color eye_color birth_year sex   gender</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; </span>
<span class="co">#&gt; 1 Dud …     94    45 none       blue, grey yellow            NA male  mascu…</span>
<span class="co">#&gt; 2 Bossk    190   113 none       green      red               53 male  mascu…</span>
<span class="co">#&gt; 3 Shaa…    178    57 none       red, blue… black             NA fema… femin…</span>
<span class="co">#&gt; 4 Dormé    165    NA brown      light      brown             NA fema… femin…</span>
<span class="co">#&gt; # … with 1 more row, and 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;,</span>
<span class="co">#&gt; #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</span>
<span class="no">starwars</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/slice.html">slice_sample</a></span>(<span class="kw">prop</span> <span class="kw">=</span> <span class="fl">0.1</span>)
<span class="co">#&gt; # A tibble: 8 x 14</span>
<span class="co">#&gt;   name  height  mass hair_color skin_color eye_color birth_year sex   gender</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; </span>
<span class="co">#&gt; 1 Qui-…    193    89 brown      fair       blue              92 male  mascu…</span>
<span class="co">#&gt; 2 Dext…    198   102 none       brown      yellow            NA male  mascu…</span>
<span class="co">#&gt; 3 R4-P…     96    NA none       silver, r… red, blue         NA none  femin…</span>
<span class="co">#&gt; 4 Lama…    229    88 none       grey       black             NA male  mascu…</span>
<span class="co">#&gt; # … with 4 more rows, and 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;,</span>
<span class="co">#&gt; #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</span></pre></body></html></div>
<p>Use <code>replace = TRUE</code> to perform a bootstrap sample. If needed, you can weight the sample with the <code>weight</code> argument.</p>
<ul>
<li>slice_min() and slice_max() select rows with highest or lowest values of a variable. Note that we first must choose only the values which are not NA.</li>
</ul>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">starwars</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/filter.html">filter</a></span>(!<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">height</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/slice.html">slice_max</a></span>(<span class="no">height</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="co">#&gt; # A tibble: 3 x 14</span>
<span class="co">#&gt;   name  height  mass hair_color skin_color eye_color birth_year sex   gender</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; </span>
<span class="co">#&gt; 1 Yara…    264    NA none       white      yellow            NA male  mascu…</span>
<span class="co">#&gt; 2 Tarf…    234   136 brown      brown      blue              NA male  mascu…</span>
<span class="co">#&gt; 3 Lama…    229    88 none       grey       black             NA male  mascu…</span>
<span class="co">#&gt; # … with 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,</span>
<span class="co">#&gt; #   vehicles &lt;list&gt;, starships &lt;list&gt;</span></pre></body></html></div>
</div>
<div id="select-columns-with-select" class="section level3">
<h3 class="hasAnchor">
<a href="#select-columns-with-select" class="anchor"></a>Select columns with <code>select()</code>
</h3>
<p>Often you work with large datasets with many columns but only a few are actually of interest to you. <code><a href="../reference/select.html">select()</a></code> allows you to rapidly zoom in on a useful subset using operations that usually only work on numeric variable positions:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="co"># Select columns by name</span>
<span class="no">starwars</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/select.html">select</a></span>(<span class="no">hair_color</span>, <span class="no">skin_color</span>, <span class="no">eye_color</span>)
<span class="co">#&gt; # A tibble: 87 x 3</span>
<span class="co">#&gt;   hair_color skin_color  eye_color</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;    </span>
<span class="co">#&gt; 1 blond      fair        blue     </span>
<span class="co">#&gt; 2 &lt;NA&gt;       gold        yellow   </span>
<span class="co">#&gt; 3 &lt;NA&gt;       white, blue red      </span>
<span class="co">#&gt; 4 none       white       yellow   </span>
<span class="co">#&gt; # … with 83 more rows</span>
<span class="co"># Select all columns between hair_color and eye_color (inclusive)</span>
<span class="no">starwars</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/select.html">select</a></span>(<span class="no">hair_color</span>:<span class="no">eye_color</span>)
<span class="co">#&gt; # A tibble: 87 x 3</span>
<span class="co">#&gt;   hair_color skin_color  eye_color</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;    </span>
<span class="co">#&gt; 1 blond      fair        blue     </span>
<span class="co">#&gt; 2 &lt;NA&gt;       gold        yellow   </span>
<span class="co">#&gt; 3 &lt;NA&gt;       white, blue red      </span>
<span class="co">#&gt; 4 none       white       yellow   </span>
<span class="co">#&gt; # … with 83 more rows</span>
<span class="co"># Select all columns except those from hair_color to eye_color (inclusive)</span>
<span class="no">starwars</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/select.html">select</a></span>(-(<span class="no">hair_color</span>:<span class="no">eye_color</span>))
<span class="co">#&gt; # A tibble: 87 x 11</span>
<span class="co">#&gt;   name  height  mass birth_year sex   gender homeworld species films vehicles</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;   &lt;lis&gt; &lt;list&gt;  </span>
<span class="co">#&gt; 1 Luke…    172    77       19   male  mascu… Tatooine  Human   &lt;chr… &lt;chr [2…</span>
<span class="co">#&gt; 2 C-3PO    167    75      112   none  mascu… Tatooine  Droid   &lt;chr… &lt;chr [0…</span>
<span class="co">#&gt; 3 R2-D2     96    32       33   none  mascu… Naboo     Droid   &lt;chr… &lt;chr [0…</span>
<span class="co">#&gt; 4 Dart…    202   136       41.9 male  mascu… Tatooine  Human   &lt;chr… &lt;chr [0…</span>
<span class="co">#&gt; # … with 83 more rows, and 1 more variable: starships &lt;list&gt;</span>
<span class="co"># Select all columns ending with color</span>
<span class="no">starwars</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/select.html">select</a></span>(<span class="fu"><a href="https://tidyselect.r-lib.org/reference/select_helpers.html">ends_with</a></span>(<span class="st">"color"</span>))
<span class="co">#&gt; # A tibble: 87 x 3</span>
<span class="co">#&gt;   hair_color skin_color  eye_color</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;    </span>
<span class="co">#&gt; 1 blond      fair        blue     </span>
<span class="co">#&gt; 2 &lt;NA&gt;       gold        yellow   </span>
<span class="co">#&gt; 3 &lt;NA&gt;       white, blue red      </span>
<span class="co">#&gt; 4 none       white       yellow   </span>
<span class="co">#&gt; # … with 83 more rows</span></pre></body></html></div>
<p>There are a number of helper functions you can use within <code><a href="../reference/select.html">select()</a></code>, like <code><a href="https://tidyselect.r-lib.org/reference/select_helpers.html">starts_with()</a></code>, <code><a href="https://tidyselect.r-lib.org/reference/select_helpers.html">ends_with()</a></code>, <code><a href="https://tidyselect.r-lib.org/reference/select_helpers.html">matches()</a></code> and <code><a href="https://tidyselect.r-lib.org/reference/select_helpers.html">contains()</a></code>. These let you quickly match larger blocks of variables that meet some criterion. See <code><a href="../reference/select.html">?select</a></code> for more details.</p>
<p>You can rename variables with <code><a href="../reference/select.html">select()</a></code> by using named arguments:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">starwars</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/select.html">select</a></span>(<span class="kw">home_world</span> <span class="kw">=</span> <span class="no">homeworld</span>)
<span class="co">#&gt; # A tibble: 87 x 1</span>
<span class="co">#&gt;   home_world</span>
<span class="co">#&gt;   &lt;chr&gt;     </span>
<span class="co">#&gt; 1 Tatooine  </span>
<span class="co">#&gt; 2 Tatooine  </span>
<span class="co">#&gt; 3 Naboo     </span>
<span class="co">#&gt; 4 Tatooine  </span>
<span class="co">#&gt; # … with 83 more rows</span></pre></body></html></div>
<p>But because <code><a href="../reference/select.html">select()</a></code> drops all the variables not explicitly mentioned, it’s not that useful. Instead, use <code><a href="../reference/rename.html">rename()</a></code>:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">starwars</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/rename.html">rename</a></span>(<span class="kw">home_world</span> <span class="kw">=</span> <span class="no">homeworld</span>)
<span class="co">#&gt; # A tibble: 87 x 14</span>
<span class="co">#&gt;   name  height  mass hair_color skin_color eye_color birth_year sex   gender</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; </span>
<span class="co">#&gt; 1 Luke…    172    77 blond      fair       blue            19   male  mascu…</span>
<span class="co">#&gt; 2 C-3PO    167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…</span>
<span class="co">#&gt; 3 R2-D2     96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…</span>
<span class="co">#&gt; 4 Dart…    202   136 none       white      yellow          41.9 male  mascu…</span>
<span class="co">#&gt; # … with 83 more rows, and 5 more variables: home_world &lt;chr&gt;, species &lt;chr&gt;,</span>
<span class="co">#&gt; #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</span></pre></body></html></div>
</div>
<div id="add-new-columns-with-mutate" class="section level3">
<h3 class="hasAnchor">
<a href="#add-new-columns-with-mutate" class="anchor"></a>Add new columns with <code>mutate()</code>
</h3>
<p>Besides selecting sets of existing columns, it’s often useful to add new columns that are functions of existing columns. This is the job of <code><a href="../reference/mutate.html">mutate()</a></code>:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">starwars</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/mutate.html">mutate</a></span>(<span class="kw">height_m</span> <span class="kw">=</span>  <span class="no">height</span> / <span class="fl">100</span>)
<span class="co">#&gt; # A tibble: 87 x 15</span>
<span class="co">#&gt;   name  height  mass hair_color skin_color eye_color birth_year sex   gender</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; </span>
<span class="co">#&gt; 1 Luke…    172    77 blond      fair       blue            19   male  mascu…</span>
<span class="co">#&gt; 2 C-3PO    167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…</span>
<span class="co">#&gt; 3 R2-D2     96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…</span>
<span class="co">#&gt; 4 Dart…    202   136 none       white      yellow          41.9 male  mascu…</span>
<span class="co">#&gt; # … with 83 more rows, and 6 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;,</span>
<span class="co">#&gt; #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;, height_m &lt;dbl&gt;</span></pre></body></html></div>
<p>We can’t see the height in meters we just calculated, but we can fix that using a select command.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">starwars</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/mutate.html">mutate</a></span>(<span class="kw">height_m</span> <span class="kw">=</span> <span class="no">height</span> / <span class="fl">100</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/select.html">select</a></span>(<span class="no">height_m</span>, <span class="no">height</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/select_helpers.html">everything</a></span>())
<span class="co">#&gt; # A tibble: 87 x 15</span>
<span class="co">#&gt;   height_m height name   mass hair_color skin_color eye_color birth_year sex  </span>
<span class="co">#&gt;      &lt;dbl&gt;  &lt;int&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1     1.72    172 Luke…    77 blond      fair       blue            19   male </span>
<span class="co">#&gt; 2     1.67    167 C-3PO    75 &lt;NA&gt;       gold       yellow         112   none </span>
<span class="co">#&gt; 3     0.96     96 R2-D2    32 &lt;NA&gt;       white, bl… red             33   none </span>
<span class="co">#&gt; 4     2.02    202 Dart…   136 none       white      yellow          41.9 male </span>
<span class="co">#&gt; # … with 83 more rows, and 6 more variables: gender &lt;chr&gt;, homeworld &lt;chr&gt;,</span>
<span class="co">#&gt; #   species &lt;chr&gt;, films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</span></pre></body></html></div>
<p><code><a href="../reference/mutate.html">dplyr::mutate()</a></code> is similar to the base <code><a href="https://rdrr.io/r/base/transform.html">transform()</a></code>, but allows you to refer to columns that you’ve just created:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">starwars</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/mutate.html">mutate</a></span>(
  <span class="kw">height_m</span> <span class="kw">=</span> <span class="no">height</span> / <span class="fl">100</span>,
  <span class="kw">BMI</span> <span class="kw">=</span> <span class="no">mass</span>/(<span class="no">height_m</span>^<span class="fl">2</span>)
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/select.html">select</a></span>(<span class="no">BMI</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/select_helpers.html">everything</a></span>())
<span class="co">#&gt; # A tibble: 87 x 16</span>
<span class="co">#&gt;     BMI name  height  mass hair_color skin_color eye_color birth_year sex  </span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1  26.0 Luke…    172    77 blond      fair       blue            19   male </span>
<span class="co">#&gt; 2  26.9 C-3PO    167    75 &lt;NA&gt;       gold       yellow         112   none </span>
<span class="co">#&gt; 3  34.7 R2-D2     96    32 &lt;NA&gt;       white, bl… red             33   none </span>
<span class="co">#&gt; 4  33.3 Dart…    202   136 none       white      yellow          41.9 male </span>
<span class="co">#&gt; # … with 83 more rows, and 7 more variables: gender &lt;chr&gt;, homeworld &lt;chr&gt;,</span>
<span class="co">#&gt; #   species &lt;chr&gt;, films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;,</span>
<span class="co">#&gt; #   height_m &lt;dbl&gt;</span></pre></body></html></div>
<p>If you only want to keep the new variables, use <code><a href="../reference/mutate.html">transmute()</a></code>:</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">starwars</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/mutate.html">transmute</a></span>(
  <span class="kw">height_m</span> <span class="kw">=</span> <span class="no">height</span> / <span class="fl">100</span>,
  <span class="kw">BMI</span> <span class="kw">=</span> <span class="no">mass</span>/(<span class="no">height_m</span>^<span class="fl">2</span>)
)
<span class="co">#&gt; # A tibble: 87 x 2</span>
<span class="co">#&gt;   height_m   BMI</span>
<span class="co">#&gt;      &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1     1.72  26.0</span>
<span class="co">#&gt; 2     1.67  26.9</span>
<span class="co">#&gt; 3     0.96  34.7</span>
<span class="co">#&gt; 4     2.02  33.3</span>
<span class="co">#&gt; # … with 83 more rows</span></pre></body></html></div>
</div>
<div id="change-column-order-with-relocate" class="section level3">
<h3 class="hasAnchor">
<a href="#change-column-order-with-relocate" class="anchor"></a>Change column order with <code>relocate()</code>
</h3>
<p>Use a similar syntax as <code><a href="../reference/select.html">select()</a></code> to move blocks of columns at once</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">starwars</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/relocate.html">relocate</a></span>(<span class="no">sex</span>:<span class="no">homeworld</span>, <span class="kw">.before</span> <span class="kw">=</span> <span class="no">height</span>)
<span class="co">#&gt; # A tibble: 87 x 14</span>
<span class="co">#&gt;   name  sex   gender homeworld height  mass hair_color skin_color eye_color</span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;    </span>
<span class="co">#&gt; 1 Luke… male  mascu… Tatooine     172    77 blond      fair       blue     </span>
<span class="co">#&gt; 2 C-3PO none  mascu… Tatooine     167    75 &lt;NA&gt;       gold       yellow   </span>
<span class="co">#&gt; 3 R2-D2 none  mascu… Naboo         96    32 &lt;NA&gt;       white, bl… red      </span>
<span class="co">#&gt; 4 Dart… male  mascu… Tatooine     202   136 none       white      yellow   </span>
<span class="co">#&gt; # … with 83 more rows, and 5 more variables: birth_year &lt;dbl&gt;, species &lt;chr&gt;,</span>
<span class="co">#&gt; #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</span></pre></body></html></div>
</div>
<div id="summarise-values-with-summarise" class="section level3">
<h3 class="hasAnchor">
<a href="#summarise-values-with-summarise" class="anchor"></a>Summarise values with <code>summarise()</code>
</h3>
<p>The last verb is <code><a href="../reference/summarise.html">summarise()</a></code>. It collapses a data frame to a single row.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">starwars</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/summarise.html">summarise</a></span>(
    <span class="kw">height</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">height</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
  )
<span class="co">#&gt; # A tibble: 1 x 1</span>
<span class="co">#&gt;   height</span>
<span class="co">#&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1   174.</span></pre></body></html></div>
<p>It’s not that useful until we learn the <code><a href="../reference/group_by.html">group_by()</a></code> verb below.</p>
</div>
<div id="commonalities" class="section level3">
<h3 class="hasAnchor">
<a href="#commonalities" class="anchor"></a>Commonalities</h3>
<p>You may have noticed that the syntax and function of all these verbs are very similar:</p>
<ul>
<li><p>The first argument is a data frame.</p></li>
<li><p>The subsequent arguments describe what to do with the data frame. You can refer to columns in the data frame directly without using <code><a href="https://rdrr.io/r/base/Extract.html">$</a></code>.</p></li>
<li><p>The result is a new data frame</p></li>
</ul>
<p>Together these properties make it easy to chain together multiple simple steps to achieve a complex result.</p>
<p>These five functions provide the basis of a language of data manipulation. At the most basic level, you can only alter a tidy data frame in five useful ways: you can reorder the rows (<code><a href="../reference/arrange.html">arrange()</a></code>), pick observations and variables of interest (<code><a href="../reference/filter.html">filter()</a></code> and <code><a href="../reference/select.html">select()</a></code>), add new variables that are functions of existing variables (<code><a href="../reference/mutate.html">mutate()</a></code>), or collapse many values to a summary (<code><a href="../reference/summarise.html">summarise()</a></code>).</p>
</div>
</div>
<div id="combining-functions-with" class="section level2">
<h2 class="hasAnchor">
<a href="#combining-functions-with" class="anchor"></a>Combining functions with <code>%&gt;%</code>
</h2>
<p>The dplyr API is functional in the sense that function calls don’t have side-effects. You must always save their results. This doesn’t lead to particularly elegant code, especially if you want to do many operations at once. You either have to do it step-by-step:</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">a1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/group_by.html">group_by</a></span>(<span class="no">starwars</span>, <span class="no">species</span>, <span class="no">sex</span>)
<span class="no">a2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/select.html">select</a></span>(<span class="no">a1</span>, <span class="no">height</span>, <span class="no">mass</span>)
<span class="no">a3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/summarise.html">summarise</a></span>(<span class="no">a2</span>,
  <span class="kw">height</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">height</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>),
  <span class="kw">mass</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">mass</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>))</pre></body></html></div>
<p>Or if you don’t want to name the intermediate results, you need to wrap the function calls inside each other:</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="fu"><a href="../reference/summarise.html">summarise</a></span>(
  <span class="fu"><a href="../reference/select.html">select</a></span>(
    <span class="fu"><a href="../reference/group_by.html">group_by</a></span>(<span class="no">starwars</span>, <span class="no">species</span>, <span class="no">sex</span>),
      <span class="no">height</span>, <span class="no">mass</span>
    ),
    <span class="kw">height</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">height</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>),
    <span class="kw">mass</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">mass</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
  )
<span class="co">#&gt; Adding missing grouping variables: `species`, `sex`</span>
<span class="co">#&gt; # A tibble: 41 x 4</span>
<span class="co">#&gt; # Groups:   species [38]</span>
<span class="co">#&gt;   species  sex   height  mass</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Aleena   male      79    15</span>
<span class="co">#&gt; 2 Besalisk male     198   102</span>
<span class="co">#&gt; 3 Cerean   male     198    82</span>
<span class="co">#&gt; 4 Chagrian male     196   NaN</span>
<span class="co">#&gt; # … with 37 more rows</span></pre></body></html></div>
<p>This is difficult to read because the order of the operations is from inside to out. Thus, the arguments are a long way away from the function. To get around this problem, dplyr provides the <code><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></code> operator from magrittr. <code>x %&gt;% f(y)</code> turns into <code>f(x, y)</code> so you can use it to rewrite multiple operations that you can read left-to-right, top-to-bottom (reading the pipe operator as “then”):</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">starwars</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/group_by.html">group_by</a></span>(<span class="no">species</span>, <span class="no">sex</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/select.html">select</a></span>(<span class="no">height</span>, <span class="no">mass</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/summarise.html">summarise</a></span>(
    <span class="kw">height</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">height</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>),
    <span class="kw">mass</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">mass</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
  )</pre></body></html></div>
</div>
<div id="patterns-of-operations" class="section level2">
<h2 class="hasAnchor">
<a href="#patterns-of-operations" class="anchor"></a>Patterns of operations</h2>
<p>The dplyr verbs can be classified by the type of operations they accomplish (we sometimes speak of their <strong>semantics</strong>, i.e., their meaning). It’s helpful to have a good grasp of the difference between select and mutate operations.</p>
<div id="selecting-operations" class="section level3">
<h3 class="hasAnchor">
<a href="#selecting-operations" class="anchor"></a>Selecting operations</h3>
<p>One of the appealing features of dplyr is that you can refer to columns from the tibble as if they were regular variables. However, the syntactic uniformity of referring to bare column names hides semantical differences across the verbs. A column symbol supplied to <code><a href="../reference/select.html">select()</a></code> does not have the same meaning as the same symbol supplied to <code><a href="../reference/mutate.html">mutate()</a></code>.</p>
<p>Selecting operations expect column names and positions. Hence, when you call <code><a href="../reference/select.html">select()</a></code> with bare variable names, they actually represent their own positions in the tibble. The following calls are completely equivalent from dplyr’s point of view:</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="co"># `year` represents the integer 1</span>
<span class="fu"><a href="../reference/select.html">select</a></span>(<span class="no">starwars</span>, <span class="no">name</span>)
<span class="co">#&gt; # A tibble: 87 x 1</span>
<span class="co">#&gt;   name          </span>
<span class="co">#&gt;   &lt;chr&gt;         </span>
<span class="co">#&gt; 1 Luke Skywalker</span>
<span class="co">#&gt; 2 C-3PO         </span>
<span class="co">#&gt; 3 R2-D2         </span>
<span class="co">#&gt; 4 Darth Vader   </span>
<span class="co">#&gt; # … with 83 more rows</span>
<span class="fu"><a href="../reference/select.html">select</a></span>(<span class="no">starwars</span>, <span class="fl">1</span>)
<span class="co">#&gt; # A tibble: 87 x 1</span>
<span class="co">#&gt;   name          </span>
<span class="co">#&gt;   &lt;chr&gt;         </span>
<span class="co">#&gt; 1 Luke Skywalker</span>
<span class="co">#&gt; 2 C-3PO         </span>
<span class="co">#&gt; 3 R2-D2         </span>
<span class="co">#&gt; 4 Darth Vader   </span>
<span class="co">#&gt; # … with 83 more rows</span></pre></body></html></div>
<p>By the same token, this means that you cannot refer to variables from the surrounding context if they have the same name as one of the columns. In the following example, <code>height</code> still represents 2, not 5:</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="no">height</span> <span class="kw">&lt;-</span> <span class="fl">5</span>
<span class="fu"><a href="../reference/select.html">select</a></span>(<span class="no">starwars</span>, <span class="no">height</span>)
<span class="co">#&gt; # A tibble: 87 x 1</span>
<span class="co">#&gt;   height</span>
<span class="co">#&gt;    &lt;int&gt;</span>
<span class="co">#&gt; 1    172</span>
<span class="co">#&gt; 2    167</span>
<span class="co">#&gt; 3     96</span>
<span class="co">#&gt; 4    202</span>
<span class="co">#&gt; # … with 83 more rows</span></pre></body></html></div>
<p>One useful subtlety is that this only applies to bare names and to selecting calls like <code><a href="https://rdrr.io/r/base/c.html">c(height, mass)</a></code> or <code>height:mass</code>. In all other cases, the columns of the data frame are not put in scope. This allows you to refer to contextual variables in selection helpers:</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="no">name</span> <span class="kw">&lt;-</span> <span class="st">"color"</span>
<span class="fu"><a href="../reference/select.html">select</a></span>(<span class="no">starwars</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/select_helpers.html">ends_with</a></span>(<span class="no">name</span>))
<span class="co">#&gt; # A tibble: 87 x 3</span>
<span class="co">#&gt;   hair_color skin_color  eye_color</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;    </span>
<span class="co">#&gt; 1 blond      fair        blue     </span>
<span class="co">#&gt; 2 &lt;NA&gt;       gold        yellow   </span>
<span class="co">#&gt; 3 &lt;NA&gt;       white, blue red      </span>
<span class="co">#&gt; 4 none       white       yellow   </span>
<span class="co">#&gt; # … with 83 more rows</span></pre></body></html></div>
<p>These semantics are usually intuitive. But note the subtle difference:</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="no">name</span> <span class="kw">&lt;-</span> <span class="fl">5</span>
<span class="fu"><a href="../reference/select.html">select</a></span>(<span class="no">starwars</span>, <span class="no">name</span>, <span class="fu"><a href="https://rdrr.io/r/base/identity.html">identity</a></span>(<span class="no">name</span>))
<span class="co">#&gt; # A tibble: 87 x 2</span>
<span class="co">#&gt;   name           skin_color </span>
<span class="co">#&gt;   &lt;chr&gt;          &lt;chr&gt;      </span>
<span class="co">#&gt; 1 Luke Skywalker fair       </span>
<span class="co">#&gt; 2 C-3PO          gold       </span>
<span class="co">#&gt; 3 R2-D2          white, blue</span>
<span class="co">#&gt; 4 Darth Vader    white      </span>
<span class="co">#&gt; # … with 83 more rows</span></pre></body></html></div>
<p>In the first argument, <code>name</code> represents its own position <code>1</code>. In the second argument, <code>name</code> is evaluated in the surrounding context and represents the fifth column.</p>
<p>For a long time, <code><a href="../reference/select.html">select()</a></code> used to only understand column positions. Counting from dplyr 0.6, it now understands column names as well. This makes it a bit easier to program with <code><a href="../reference/select.html">select()</a></code>:</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="no">vars</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"name"</span>, <span class="st">"height"</span>)
<span class="fu"><a href="../reference/select.html">select</a></span>(<span class="no">starwars</span>, <span class="fu">all_of</span>(<span class="no">vars</span>), <span class="st">"mass"</span>)
<span class="co">#&gt; # A tibble: 87 x 3</span>
<span class="co">#&gt;   name           height  mass</span>
<span class="co">#&gt;   &lt;chr&gt;           &lt;int&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Luke Skywalker    172    77</span>
<span class="co">#&gt; 2 C-3PO             167    75</span>
<span class="co">#&gt; 3 R2-D2              96    32</span>
<span class="co">#&gt; 4 Darth Vader       202   136</span>
<span class="co">#&gt; # … with 83 more rows</span></pre></body></html></div>
</div>
<div id="mutating-operations" class="section level3">
<h3 class="hasAnchor">
<a href="#mutating-operations" class="anchor"></a>Mutating operations</h3>
<p>Mutate semantics are quite different from selection semantics. Whereas <code><a href="../reference/select.html">select()</a></code> expects column names or positions, <code><a href="../reference/mutate.html">mutate()</a></code> expects <em>column vectors</em>. We will set up a smaller tibble to use for our examples.</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="no">df</span> <span class="kw">&lt;-</span> <span class="no">starwars</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/select.html">select</a></span>(<span class="no">name</span>, <span class="no">height</span>, <span class="no">mass</span>)</pre></body></html></div>
<p>When we use <code><a href="../reference/select.html">select()</a></code>, the bare column names stand for their own positions in the tibble. For <code><a href="../reference/mutate.html">mutate()</a></code> on the other hand, column symbols represent the actual column vectors stored in the tibble. Consider what happens if we give a string or a number to <code><a href="../reference/mutate.html">mutate()</a></code>:</p>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="fu"><a href="../reference/mutate.html">mutate</a></span>(<span class="no">df</span>, <span class="st">"height"</span>, <span class="fl">2</span>)
<span class="co">#&gt; # A tibble: 87 x 5</span>
<span class="co">#&gt;   name           height  mass `"height"`   `2`</span>
<span class="co">#&gt;   &lt;chr&gt;           &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Luke Skywalker    172    77 height         2</span>
<span class="co">#&gt; 2 C-3PO             167    75 height         2</span>
<span class="co">#&gt; 3 R2-D2              96    32 height         2</span>
<span class="co">#&gt; 4 Darth Vader       202   136 height         2</span>
<span class="co">#&gt; # … with 83 more rows</span></pre></body></html></div>
<p><code><a href="../reference/mutate.html">mutate()</a></code> gets length-1 vectors that it interprets as new columns in the data frame. These vectors are recycled so they match the number of rows. That’s why it doesn’t make sense to supply expressions like <code>"height" + 10</code> to <code><a href="../reference/mutate.html">mutate()</a></code>. This amounts to adding 10 to a string! The correct expression is:</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="fu"><a href="../reference/mutate.html">mutate</a></span>(<span class="no">df</span>, <span class="no">height</span> + <span class="fl">10</span>)
<span class="co">#&gt; # A tibble: 87 x 4</span>
<span class="co">#&gt;   name           height  mass `height + 10`</span>
<span class="co">#&gt;   &lt;chr&gt;           &lt;int&gt; &lt;dbl&gt;         &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Luke Skywalker    172    77           182</span>
<span class="co">#&gt; 2 C-3PO             167    75           177</span>
<span class="co">#&gt; 3 R2-D2              96    32           106</span>
<span class="co">#&gt; 4 Darth Vader       202   136           212</span>
<span class="co">#&gt; # … with 83 more rows</span></pre></body></html></div>
<p>In the same way, you can unquote values from the context if these values represent a valid column. They must be either length 1 (they then get recycled) or have the same length as the number of rows. In the following example we create a new vector that we add to the data frame:</p>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="no">var</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">df</span>))
<span class="fu"><a href="../reference/mutate.html">mutate</a></span>(<span class="no">df</span>, <span class="kw">new</span> <span class="kw">=</span> <span class="no">var</span>)
<span class="co">#&gt; # A tibble: 87 x 4</span>
<span class="co">#&gt;   name           height  mass   new</span>
<span class="co">#&gt;   &lt;chr&gt;           &lt;int&gt; &lt;dbl&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1 Luke Skywalker    172    77     1</span>
<span class="co">#&gt; 2 C-3PO             167    75     2</span>
<span class="co">#&gt; 3 R2-D2              96    32     3</span>
<span class="co">#&gt; 4 Darth Vader       202   136     4</span>
<span class="co">#&gt; # … with 83 more rows</span></pre></body></html></div>
<p>A case in point is <code><a href="../reference/group_by.html">group_by()</a></code>. While you might think it has select semantics, it actually has mutate semantics. This is quite handy as it allows to group by a modified column:</p>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="fu"><a href="../reference/group_by.html">group_by</a></span>(<span class="no">starwars</span>, <span class="no">sex</span>)
<span class="co">#&gt; # A tibble: 87 x 14</span>
<span class="co">#&gt; # Groups:   sex [5]</span>
<span class="co">#&gt;   name  height  mass hair_color skin_color eye_color birth_year sex   gender</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; </span>
<span class="co">#&gt; 1 Luke…    172    77 blond      fair       blue            19   male  mascu…</span>
<span class="co">#&gt; 2 C-3PO    167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…</span>
<span class="co">#&gt; 3 R2-D2     96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…</span>
<span class="co">#&gt; 4 Dart…    202   136 none       white      yellow          41.9 male  mascu…</span>
<span class="co">#&gt; # … with 83 more rows, and 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;,</span>
<span class="co">#&gt; #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</span>
<span class="fu"><a href="../reference/group_by.html">group_by</a></span>(<span class="no">starwars</span>, <span class="kw">sex</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">sex</span>))
<span class="co">#&gt; # A tibble: 87 x 14</span>
<span class="co">#&gt; # Groups:   sex [5]</span>
<span class="co">#&gt;   name  height  mass hair_color skin_color eye_color birth_year sex   gender</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;fct&gt; &lt;chr&gt; </span>
<span class="co">#&gt; 1 Luke…    172    77 blond      fair       blue            19   male  mascu…</span>
<span class="co">#&gt; 2 C-3PO    167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…</span>
<span class="co">#&gt; 3 R2-D2     96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…</span>
<span class="co">#&gt; 4 Dart…    202   136 none       white      yellow          41.9 male  mascu…</span>
<span class="co">#&gt; # … with 83 more rows, and 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;,</span>
<span class="co">#&gt; #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</span>
<span class="fu"><a href="../reference/group_by.html">group_by</a></span>(<span class="no">starwars</span>, <span class="kw">height_binned</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span>(<span class="no">height</span>, <span class="fl">3</span>))
<span class="co">#&gt; # A tibble: 87 x 15</span>
<span class="co">#&gt; # Groups:   height_binned [4]</span>
<span class="co">#&gt;   name  height  mass hair_color skin_color eye_color birth_year sex   gender</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; </span>
<span class="co">#&gt; 1 Luke…    172    77 blond      fair       blue            19   male  mascu…</span>
<span class="co">#&gt; 2 C-3PO    167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…</span>
<span class="co">#&gt; 3 R2-D2     96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…</span>
<span class="co">#&gt; 4 Dart…    202   136 none       white      yellow          41.9 male  mascu…</span>
<span class="co">#&gt; # … with 83 more rows, and 6 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;,</span>
<span class="co">#&gt; #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;, height_binned &lt;fct&gt;</span></pre></body></html></div>
<p>This is why you can’t supply a column name to <code><a href="../reference/group_by.html">group_by()</a></code>. This amounts to creating a new column containing the string recycled to the number of rows:</p>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="fu"><a href="../reference/group_by.html">group_by</a></span>(<span class="no">df</span>, <span class="st">"month"</span>)
<span class="co">#&gt; # A tibble: 87 x 4</span>
<span class="co">#&gt; # Groups:   "month" [1]</span>
<span class="co">#&gt;   name           height  mass `"month"`</span>
<span class="co">#&gt;   &lt;chr&gt;           &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;    </span>
<span class="co">#&gt; 1 Luke Skywalker    172    77 month    </span>
<span class="co">#&gt; 2 C-3PO             167    75 month    </span>
<span class="co">#&gt; 3 R2-D2              96    32 month    </span>
<span class="co">#&gt; 4 Darth Vader       202   136 month    </span>
<span class="co">#&gt; # … with 83 more rows</span></pre></body></html></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="tidyverse">
  <p>dplyr is a part of the <strong>tidyverse</strong>, an ecosystem of packages designed with common APIs and a shared philosophy. Learn more at <a href="https://tidyverse.org">tidyverse.org</a>.</p>
</div>

<div class="author">
  <p>
    Developed by <a href="http://hadley.nz">Hadley Wickham</a>, Romain François, Lionel Henry, <a href="http://krlmlr.info">Kirill Müller</a>, <a href="https://www.rstudio.com"><img src="https://www.tidyverse.org/rstudio-logo.svg" alt="RStudio" height="24"></a>.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '1270c4079b26a138795263974bbf302d',
    indexName: 'tidyverse',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
